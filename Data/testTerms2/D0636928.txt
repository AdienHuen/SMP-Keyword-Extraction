#数据库/gi读写/gi分离/vi
原文/n：/w大致/d分/qt客户端/gi业务/gi层/gi做/v读写/gi分离/vi，/w与/cc中间件/n做/v读写/gi分离/vi。/w客户端/gi做/v读写/gi分离/vi缺点/gi是/vshi对/p业务/gi代码/gi侵入/v大/a，/w优点/gi是/vshi能够/v根据/p更/d细粒度/gi选择/gi哪些/ry方法/gi需要/v从/p读库/nz或/c主库/n取/v。/w中间件/n做/v读写/gi分离/vi，/w优点/gi自然/n是/vshi对/p业务/gi侵入/v较小/d，/w但有/c个/q问题/gi是/vshi万一/d主库/n与/cc从/p库/n间/f同步/gi存在/v延迟/v，/w一个/mq事务/gi先写/nz然后/c再/d查/v（/w查询/gi可能/v被/pbei路由/gi到/v读库/nz）/w，/w这时/rzt就/d会/v发生/v问题/gi。/w目前/t像/v360/nz的/ude1atlas/nz(/nz不/d支持/v分布式/gi分表/n)/nz,/nz阿里/nrfb/nz2/nzb/nz的/ude1cobar/nz(/nz /x不/d支持/v读写/gi分离/vi)/nz，/w及/cc淘宝/n的/ude1tddl/nz(/nz比较复杂/l)/nz，/wmysql proxy/nz(/nz不/d提供/v强制/vd主库/n读/v，/w对/p实时性/nz要求/n较高/ad的/ude1查询/gi比较/gi适合/v)/nz。/w目前/t还/d没有/v比较/gi成熟/a的/ude1数据库/gi中间件/n读写/gi分离/vi，/w各个/rz开源/gi读写/gi分离/vi中间件/n都/d有/vyou各自/rr缺点/gi。/w客户端/gi做/v读写/gi分离/vi，/w可以/v选择/gispring/gi的/ude1动态/gi数据源/gi配置/gi，/w基本原理/nz就是/v在/p业务/gidao/gi加/v标注/v@/nzdatasource/nz，/w然后/caop/gi会/v根据/p标注/v选择/gi相应/vi的/ude1数据源/gi。/w需要/v注意/v的/ude1是/vshi，/wservice/gi层/gi一个/mq事务/gi有/vyou两/nz个/q操作/gi，/w一个/mq是/vshi读/v某个/rz表/n数据/gi，/w然后/c对/p其/rz作/v处理/vn。/w如果/c该/rz业务/gi要求/n数据/gi实时性/nz高/a，/w这时/rzt要/v指明/v该/rz业务操作/gi读/v操作/gidao/gi要/v从/p主库/n读取/gi。/w