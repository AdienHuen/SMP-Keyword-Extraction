#物联网/gi架构/gi演进/vn和/cc微信/gi智能设备/gi平台/gi开发/gi
微信/gi公众号/gi（/w嵌入式/gi企鹅/n圈/qv）/w将/d新/a开辟/v专栏/gi撰写/v物联网/gi完整/a解决方案/gi的/ude1相关/vn技术/gi，/w包括/v物联网/gi架构/gi、/w云服务/gi、/w微信/gi接口/gi开发/gi、/w智能设备/gi开发/gi等/udeng。/w鉴于/p本人/rr研发/gi的/ude1进展/vn和/cc需要/v时间/gi进行/vn原创/b总结/gi，/w物联网/gi专栏/gi更新/gi会/v比较慢/l，/w近期/t嵌入式/gi企鹅/n圈/qv仍以/d嵌入式/gilinux/gi技术开发/nz经验/gi分享/gi为主/vi。/w本文/r从/p场景/gi和/cc技术/gi的/ude1角度/n去/vf理解/gi物联网/gi技术/gi和/cc方案/gi的/ude1演进/vn，/w纯粹/b是/vshi个人观点/nz，/w可能/v与/cc主流/gi定义/gi稍/d有/vyou偏差/n。/w一/nz、/w物联网/gi与/cc物/ng联/vg设备/gi本人/rr对/p物联网/gi的/ude1理解/gi是/vshi物/ng联/vg设备/gi组成/gi的/ude1网络/gi，/w因此/c物联网/gi需要/v两/nz个/q要素/gi，/w一是/nz设备/gi能够/v互联/vi，/w另一个/nz是/vshi能够/v组网/v。/w物联网/gi往往/d又/d跟/p智能硬件/gi概念/gi相结合/nz，/w当今/t物联网/gi产品/gi形态/n往往/d又/d带有/v无线连接/nz的/ude1特点/n（/w有线/b最主要/nz的/ude1弊端/n就是/v布线/gp麻烦/an）/w。/w因此/c能够/v支持/v互联/vi、/w组网/v、/w无线三/nz个/q特点/n的/ude1物/ng联/vg设备/gi技术/gi就是/v常见/a的/ude1蓝牙/gi和/ccwifi/gi了/ule。/w蓝牙/gi是/vshi近距离/nz通信/gi，/w穿墙/nz能力差/nz；/w而/ccwifi/gi距离远/n，/w可/v穿墙/nz，/w但是/c功耗/gi比较/gi高/a。/wzigbee/gi其实/d通信/gi距离/gi比/p蓝牙/gi远/a，/w功耗/gi也/d比/pwifi/gi低/a，/w看起来/v是/vshi比较/gi理想/n的/ude1物/ng联/vg技术/gi，/w但是/czigbee/gi的/ude1组网/v能力/gi比较/gi差/a，/w带宽/n低/a，/w传输/gi慢/a。/wzigbee/gi更多/ad用/p在/p工业/n控制/vn领域/gi。/w手机/gi是/vshi现代/ntc社会/n每个/r人/n不可或缺/al的/ude1产品/gi，/w蓝牙/gi和/ccwifi/gi是/vshi手机/gi的/ude1必备/vn模块/gi，/w所以/c手机/gi是/vshi最大/gm的/ude1物/ng联/vg智能设备/gi。/w另外/c，/w由于/p人/n是/vshi物联网/gi的/ude1直接/ad使用者/n，/w因此/c几乎/d所有/b的/ude1物/ng联/vg解决方案/gi都/d是/vshi围绕/v手机用户/nz展开/v。/w二/nz、/w物/ng联/vg场景/gi演进/vn1./nz手机/gi直接/ad控制物/nz联/vg设备/gi架构/gi下图/n是/vshiwifi/gi物/ng联/vg架构/gi示意图/gi：/w手机/gi连接/gi并/cc控制物/nz联/vg设备/gi是/vshi物/ng联/vg技术/gi的/ude1基础/gi，/w第一种/nz方式/n是/vshi手机/gi和/cc硬件/gi控制/vn设备/gi都/d以/pclient/nz的/ude1方式/n连接/gi路由器/gi，/w这样/rzv手机/gi和/cc硬件/gi控制/vn设备/gi都/d能/v获得/v一个/mq动态/gi的/ude1ip/gi，/w这样/rzv手机/gi可以/v通过/psocket/gi通信/gi方式/n来/vf控制/vn硬件/gi控制/vn设备/gi。/w第二种/nz方式/n是/vshi硬件/gi控制/vn设备/gi带有/vwifi ap/nz热点/gi功能/gi，/w手机/gi以/pwifi client/nz连接/gi上/fap/nz，/wap/nz的/ude1ip/gi是/vshi固定/a的/ude1，/w因此/c手机/gi也/d能够/v对/p硬件/gi控制/vn设备/gi进行/vn控制/vn。/w这种/r物/ng联/vg方式/n一般/ad只是/d演示/gi的/ude1模型/gi，/w实际/n应用/gi很少/ad。/w因为/c它/rr的/ude1缺点/gi显而易见/bl，/w我们/rr都/d知道/vsocket/gi通信/gi需要/v知道/v通信/gi对方/n的/ude1ip/gi，/w因此/c手机/gi上/f的/ude1app/gi控制/vn硬件/gi设备/gi时/qt需要/v填入/vf设备/gi的/ude1ip/gi。/w第一种/nz方式/n的/ude1ip/gi是/vshi动态/gi的/ude1，/w需要/v通过/p路由器/gi的/ude1web/gi控制/vn页面/gi（/w一般/ad电脑/gi连接/gi后/f浏览器/gi输入/v192.168.1.1/nz）/w获得/v，/w这/rzv在/p商用/b应用/gi中/f不/d可能/v存在/v。/w第二种/nz方式/n也/d需要/v手机/giapp/gi输入/v固定/a的/ude1ip/gi，/w控制/vn不同/a的/ude1设备/gi就/d得/ude3输入/v不同/a的/ude1ip/gi，/w用户/gi体验/v不好/a。/w而且/c这种/r物/ng联/vg跟/p遥控/vn没有/v本质/n的/ude1区别/gi，/w不利于/v获取/gi用户/gi的/ude1信息/gi。/w而/cc获取/gi用户/gi的/ude1信息/gi并/cc提供/v优质服务/nz才/d是/vshi物联网/gi的/ude1核心要素/gi。/w2./nz基于/p独立/a后台/gi服务/gi的/ude1物/ng联/vg架构/gi下图/n是/vshiwifi/gi物/ng联/vg架构/gi示意图/gi：/w这种/r物/ng联/vg架构/gi中的/v独立/a服务器/gi是/vshi以/p域名/gi的/ude1方式/n存在/v，/w这样/rzv可以/v直接/ad解决/v动态/giip/gi不/d固定/a的/ude1问题/gi。/w另外/c，/w这种/r物/ng联/vg架构/gi中/f手机/gi和/cc硬件/gi控制/vn都/d需要/v以/p用户名/n注册/gi和/cc登陆/vi的/ude1方式/n来/vf访问/gi独立/a服务器/gi，/w并/cc由/p服务器/gi通过/p心跳/vi技术/gi来/vf确认/v手机/gi和/cc硬件/gi控制/vn设备/gi的/ude1在线/vn状态/gi。/w手机/gi和/cc硬件/gi控制/vn在/p服务器/gi看来/v都/d是/vshi普通/a的/ude1物/ng联/vg设备/gi，/w它们/rr在/p服务器/gi看来/v都/d具有/v唯一/b的/ude1用户/giid/nz，/w物/ng联/vg设备/gi登陆/vi服务器时/n服务器/gi会/v获取/gi到/v用户/giid/nz所在/n设备/gi的/ude1ip/gi地址/gi。/w而/cc手机/giapp/gi控制/vn硬件/gi设备/gi是/vshi以/p用户/giid/nz为/p依据/n进行/vn控制/vn，/w其/rz先/d将/d用户/giid/nz送往/v服务器/gi即可/v获取/gi到/v对应/vi的/ude1ip/gi地址/gi。/w后续/vn控制/vn可以/v通过/p服务器/gi，/w也/d可以/v绕过/v服务器/gi直接/ad进行/vn。/w类/giweb/gi互联/vi架构/gi在/p互联网/gi应用/gi广泛/a存在/v，/w如/vqq/gi。/w每/rz台/q手机/gi都/d以/pqq/gi账号/gi和/cc密码/gi进行/vn登录/gi，/w登录/gi后/f，/wqq/gi后台/gi服务器/gi会/v获知/v每个/r用户/gi所在/n手机/gi的/ude1ip/gi地址/gi。/w两/nz个/qqq/gi用户/gi通信/gi时会/n先/d通过/p账号/gi来/vf获取/gi对方/n的/ude1ip/gi，/w并/cc进行/vn下一步/nz通信/gi。/w这些/rz访问/gi细节/gi都/d已经/d封装/gi在/pqq/gi客户端程序/n中/f，/wqq/gi使用者/n并不需要/l理会/v。/w用户/gi间/f的/ude1通信/gi可能会/nz经过/pqq/gi服务器/gi，/w也/d可能/v绕过/v服务器进行/n。/w如/v文字/gi信息/gi一般/ad会/v送往/vqq/gi服务器进行/n信息/gi过滤/gi再/d送到/v对方/n，/w而/ccqq/gi视频/gi应该/v是/vshi双方/n直接/ad通过/pip/gi进行/vn通信/gi。/w这种/r架构/gi在/p物/ng联/vg领域/gi曾经/d是/vshi主流/gi的/ude1架构/gi，/w但是/c其/rz固有/b的/ude1缺点/gi也/d约束/gi了/ule它/rr的/ude1发展壮大/l。/w这种/r架构/gi中/f，/w独立/a服务器/gi一般/ad是/vshi由/p硬件/gi控制/vn设备/gi的/ude1销售/gi厂商/gi开发/gi维护/gi的/ude1，/w另外/c其/rz还/d需要/v向/p购买/gi硬件/gi设备/gi的/ude1用户/gi提供/v手机/giapp/gi，/w以/p让/v用户/gi能够/v进行/vn远端/nz的/ude1硬件/gi控制/vn。/w如/v小孩/n监护/vn摄像头/gi，/w厂商/gi需要/v开发/gi手机/gi监护/vnapp/gi给/p用户/gi安装/gi使用/gi。/w可以/v想到/v，/w用户/gi每/rz购买/gi一/nz种/q物/ng联/vg设备/gi，/w都/d需要/v安装/gi一个/mq不同/a的/ude1app/gi。/w这/rzv直接影响/v了/ule用户/gi体验/v。/w用户/gi一般/ad是/vshi不/d情愿/v安装/gi很/d多/a的/ude1手机/giapp/gi的/ude1，/w不仅/c安全/gi无法/v保障/vn，/w手机/gi布满/v控制/vnapp/gi时/qt，/w要/v找到/v哪款/nz设备/gi对应/vi的/ude1app/gi还要/d花/n时间/gi。/w另外/c，/w独立/a服务器/gi的/ude1厂商/gi受限于/l自己/rr的/ude1技术储备/nz和/cc运维/gi能力/gi，/w难以/d兼容/vi支持/v第三方/nz厂商/gi的/ude1物/ng联/vg设备/gi。/w3./nz基于/p统一/vn后台/gi服务/gi的/ude1物/ng联/vg架构/gi由/p第/mq2/nz点/gi，/w我们/rr自然/n可以/v想到/v，/w如果/c有/vyou一家/n实力/n超雄/nz的/ude1厂商/gi能够/v提供/v统一/vn的/ude1后台/gi服务/gi，/w并/cc被/pbei广大/b手机用户/nz使用者/n认可/vn愿意/v使用/gi，/w而/cc物/ng联/vg设备/gi厂商/gi按照/p统一/vn后台/gi服务/gi拟定/v的/ude1协议/gi进行/vn设备/gi生产/gi并/cc接入/vn到/v统一/vn的/ude1后台/gi服务/gi，/w那/rzv大一统/vl的/ude1物联网/gi大/a平台/gi将/d成为/v可能/v。/w微信/gi公众号/gi和/cc微信/gi硬件平台/l得益于/v腾讯/ntcqq/gi的/ude1超大/b用户量/n，/w很/d自然/n就/d承载/v了/ule这种/r平台/gi的/ude1实现/gi。/w完全/ad可以/v预见/vn，/w微信/gi将/d是/vshi未来/t物联网/gi的/ude1重要/a支撑/v平台/gi之一/rz，/w而/cc小米/n在/p手机/gi、/w智能家居/nz和/cc相关/vn行业/gi的/ude1布局/gi也/d是/vshi物联网/gi重要/a支撑/v平台/gi的/ude1竞争者/n。/w微信/gi拟定/v统一/vn开发/gi的/ude1协议/gi，/w让/v社会上/nz不同/a的/ude1第三方/nz硬件/gi设备/gi公司/nis接入/vn并/cc获得/v唯一/b的/ude1用户/giid/nz，/w而/cc小米/n不仅/c是/vshi统一/vn后台/gi的/ude1开发/gi维护者/nnd，/w也/d是/vshi小米/n不同/a硬件/gi设备/gi的/ude1生产者/n，/w两者/rzv走/v的/ude1路/n并不/d一致/a。/w但/c两者/rzv的/ude1共同点/n是/vshi后台/gi服务/gi是/vshi统一/vn的/ude1，/w两者/rzv的/ude1隶属/v公司/nis都/d是/vshi超大/b体量/n型/k企业/gi。/w在/p移动互联网/gi领域/gi，/w用户/gi基础/gi是/vshi非常/d核心/n的/ude1要素/gi，/w涉及/v平台/gi相关/vn的/ude1服务/gi，/w没有/v超大型/b体量/n的/ude1企业/gi很难/d快速/d构建/gi，/w顶多/d只能/v在/p垂直/gi领域/gi有所作为/vl。/w事实上/bl，/w在/p微信/gi智能/gi硬件平台/l出现/v之前/f，/w也/d有/vyou一/nz些/q企业/gi构建/gi了/ule统一/vn的/ude1后台/gi服务/gi，/w让/v第三方/nz设备/gi厂商/gi接入/vn。/w但/c受限于/l用户/gi的/ude1支持/v，/w这些/rz平台/gi都/d未能/v为/p人/n熟知/v（/w也许/d是/vshi我/rr涉猎/v这/rzv方面/n知识/gi较少/ad，/w之前/f有/vyou了解/v过/uguo一个/mq平台/gi，/w后来/t忘记/v了/ule）/w。/w这种/r架构/gi的/ude1示意图/gi如下/vi，/w以/p微信/gi和/cc蓝牙/gi设备控制/gi为/p例/n：/w微信/gi公众平台/gi的/ude1最/d核心作用/nz就是/v给/p各种/rz不同/a的/ude1外设/gi提供/v接入/vn并/cc分配/gi唯一/b的/ude1设备/giid/nz。/w微信/gi智能/gi硬件平台/l的/ude1设备/giid/nz分配/gi策略/gi包括/v外设/gi厂商/gi编码/gi和/cc设备/gi编码/gi两/nz个/q部分/n。/w设备/gi编码/gi在/p统一/vn厂商/gi里面/f是/vshi唯一/b的/ude1。/w手机/gi需要/v关注/v外设/gi厂商/gi运维/gi的/ude1微信/gi公众号/gi，/w才能/n通过/p该/rz公众号/gi的/ude1页面/gi发出/v设备/gi控制指令/nz消息/n。/w控制/vn消息/n会/v通过/p微信/gi公众号/gi服务器/gi发往/vf外设/gi厂商/gi独立/a运维/gi的/ude1后台/gi服务器/gi，/w并/cc由/p后台/gi服务器/gi作出/v处理/vn后/f向/p外设/gi发出/v控制/vn消息/n，/w该/rz消息/n会/v通过/p微信/gi公众号/gi服务器/gi到/v手机/gi的/ude1微信/gi客户端/gi，/w而/cc微信/gi控制/vn端/v调用/gi蓝牙/gijsapi/nz来/vf控制/vn蓝牙/gi外设/gi。/w手机/gi微信/gi要/v控制/vn外设/gi需要/v先/d开启/gi蓝牙/gi并/cc连接/gi上/f蓝牙/gi外设/gi。/w连接/gi协议/gi由/p微信/gi硬件平台/l制定/gi，/w称为/vairsys/nz协议/gi。/w微信/gi公众平台/gi是/vshi开放平台/nz，/w支持/v第三方/nz服务/gi接入/vn，/w同时/c提供/v微信/gi支付/gi、/w客户/n接口/gi、/w用户/gi管理/gi等/udeng九/nz大/a接口/gi供/vi第三方/nz服务/gi调用/gi。/w微信/gi公众号/gi支持/v开发者/gi模式/gi，/w开启/gi后/f即/v可以/v接入/vn第三方/nz的/ude1服务/gi。/w所谓/v微信/gi开发/gi即是/c在/p调用/gi微信/gi提供/v的/ude1接口/gi的/ude1基础上/nz完成/v业务逻辑/gi开发/gi，/w支持/v的/ude1语言/gi是/vshiphp/gi，/wasp/nz等等/udeng。/w如何/ryv构建/gi第三方/nz服务器/gi和/cc如何/ryv进行/vn微信/gi接口/gi开发/gi另文/nz再述/nz。/w蓝牙/gi和/ccwifi/gi由于/p功耗/gi的/ude1差异/n，/w其/rz互联/vi微信/gi的/ude1架构/gi也/d有/vyou差异/n，/w在/p日/b后/f的/ude1技术/gi实现/gi分享/gi中会/j详细/gi进行/vn比较/gi。/w三/nz、/wnative app  light app/nz在/p第/mq2/nz种/q架构/gi，/w手机/gi要/v控制/vn外设/gi需要/v安装/gi外设/gi厂商/gi开发/gi的/ude1app/gi，/w是/vshi原生/bapp/gi（/wnative app/nz）/w；/w而/cc在/p第/mq3/nz种/q架构/gi，/w手机/gi控制/vn外设/gi只/d需要/v关注/v外设/gi厂商/gi运维/gi的/ude1微信/gi公众号/gi，/w微信/gi是/vshi手机/gi的/ude1原生/bapp/gi，/w而/cc每个/r外设/gi厂商/gi通过/p微信/gi公众号/gi提供/v的/ude1服务/gi称为/v轻/a应用/gi（/wlight app/nz）/w。/w微信/gi是/vshi智能手机/nz的/ude1首选/vnapp/gi，/w用户量/n超大/b，/w因此/c基于/p微信/gi统一/vn后台/gi服务/gi的/ude1物/ng联/vg平台/gi是/vshi未来/t物联网/gi的/ude1重要/a支撑/v。/w欢迎/v关注/v微信/gi公众号/gi：/w嵌入式/gi企鹅/n圈/qv，/w获得/v更多/ad原创/b嵌入式/gilinux/gi和/cc物联网/gi解决方案/gi的/ude1技术/gi分享/gi。/w