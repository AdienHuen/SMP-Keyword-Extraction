#学长/n的/ude1疑惑/vn？/w？/w？/w
下面/f是/vshi一个/mq学长/n的/ude1困惑/an：/w于是/cc，/w一个/mq困惑/an了/ule我/rr很久/d的/ude1问题/gi就/d产生/v了/ule。/w如果/c一个/mqsocket/gi创建/gi后/f并/cc与/cc80端口/gi绑定/gi后/f，/w是否/v就/d意味着/v该/rz socketsocket/nz占用/v了/ule80端口/gi呢/y？/w /x如果/c是/vshi这样/rzv的/ude1，/w那么/c当/p其/rzaccept/nz一个/mq请求/gi后/f，/w生成/v的/ude1新的/asocket/gi到底/d使用/gi的/ude1是/vshi什么/ry端口/gi呢/y？/w（/w我/rr一直/d以为/v系统/gi会/v默认/v给/p其/rz分配/gi一个/mq空闲/gi的/ude1端口号/n）/w？/w如果/c是/vshi一个/mq空闲/gi端口/gi，/w那/rzv一定/b不是/c80端口/gi了/ule，/w于是/cc以后/f的/ude1tcp/gi数据包/gi的/ude1目标/gi端口/gi就/d不是/c80/nz了---防火墙/nz一定会/nz阻止/v其/rz通过/p的/ude1！/w实际上/d，/w我们/rr看到/v，/w防火墙/gi并/cc没有/v阻止/v这样/rzv的/ude1连接/gi，/w而且/c这/rzv是/vshi最/d常见/a的/ude1连接/gi请求/gi和/cc处理方式/n。/w我/rr不解/v的/ude1就是/v，/w为什么/ryv防火墙/gi没有/v阻止/v这样/rzv的/ude1连接/gi？/w？/w？/w它/rr是/vshi如何/ryv判断/gi那/rzv条/q连接/gi是因为/cconnect/nz80端口/gi生成/v的/ude1？/w？/w？/w是不是/vtcp/gi数据包/gi里/f有/vyou什么/ry特别/d的/ude1标志/n？/w？/w？/w或者说/c，/w防火墙/gi记住/v了/ule什么/ry东西/n？/w？/w？/w我/rr的/ude1解答/v：/w在/p客户端/gi的/ude1目的/giip/gi和/cc端口/gi，/w填/v的/ude1的/ude1还是/c服务器/gi的/ude1ip/gi和/cc端口/gi，/w所以/c防火墙/gi允许/v通过/p新建/v的/ude1套接字/n只/d在/p服务器/gi上/f，/w客户端/gi并不/d使用/gi新/a建立/gi的/ude1套接字/n进行/vn通信/gi之后/f的/ude1处理/vn是/vshi交由/v服务器/gi来/vf处理/vn服务器/gi，/w看到/v客户端/gi的/ude1源/ngip/gi和/cc端口/gi，/w之后/f，/w就/d交由/v子/ng进程/gi处理/vn所以/c：/w”/w于是/cc以后/f的/ude1tcp/gi数据包/gi的/ude1目标/gi端口/gi就/d不是/c80/nz了---防火墙/nz一定会/nz阻止/v其/rz通过/p的/ude1“/w这/rzv句话/q，/w的/ude1前提/n错/v啦/y，/w因为/c，/w以后/f的/ude1tcp/gi数据包/gi的/ude1目标/gi端口/gi还是/c80端口/gi。/w所以/c，/w防火墙/gi不会/v阻止/v的/ude1于是/cc，/w以后/f的/ude1tcp/gi数据包/gi的/ude1目标/gi端口/gi，/w还/d照样/d是/vshi：/w80端口/gi