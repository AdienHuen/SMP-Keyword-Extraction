#ucore/nz-/nzlab/nz3/nz /x实验报告/nz
练习/v一/nz：/w给/p未/d被/pbei映射/gi的/ude1地址映射/gi上/f物理/n页/q1/nz、/w描述/gi：/w在/plab/nz2/nz中/f我们/rr实现/gi并/cc启动/gi了/ule分页/nz机制/gi，/w现在/t我们/rr需要/v考虑/v什么/ry情况下/nz会/v产生/v页/q错误/gi异常/gi并/cc触发/gi中断/gi。/w显/v答案/gi是/vshi在/p指令/gi或/c数据/gi的/ude1虚拟地址/gi所/usuo对应/vi的/ude1物理/n页/q不在/v内存/gi中/f，/w或者/c访问/gi权限/gi不够/a的/ude1情况下/nz。/w其/rz具体/a原因/n有/vyou以下/f三点/nz：/w①页/nz表项/nz全/a为/p0/nz―/w―/w虚拟地址/gi与/cc物理地址/gi未/d建立/gi映射/gi关系/gi或/c已/d被/pbei撤销/v。/w②物理/nz页面/gi不在/v内存/gi中/f―/w―/w需要/v进行/vn换页/gi机制/gi。/w③/nz访问/gi权限/gi不够/a―/w―/w输出/gi错误信息/nz，/w并/cc退出/gi。/w根据/p以上/f三点/nz错误/gi原因/n，/w完成/v页/q错误处理/i函数/gido/nz_/nzpgfault/nz(/nz)/nz。/w2/nz、/w思路/gi：/wdo/nz_/nzpgfault/nz(/nz)/nz函数/gi从/pcr/nz2/nz寄存器/gi中/f获取/gi页/q错误/gi异常/gi的/ude1虚拟地址/gi，/w根据/perrorcode/nz来/vf查找/gi这个/rz虚拟地址/gi是否/v在/p某/rz一个/mqvma/nz的/ude1地址/gi范围内/nz，/w并且/c具有/v正确/a的/ude1权限/gi。/w如果/c满足/v上述/b两/nz个/q要求/n，/w则/d需要/v为/p分配/gi一个/mq物理页/nz。/w3/nz、/w实现/gi：/w练习二/nz：/w补充/vn完成/v基于/pfifo/gi(/nz)/nz的/ude1页面/gi替换算法/gi。/w1/nz、/w描述/gi：/w在/p上面/f的/ude1练习/v中/f，/w页/q错误/gi异常/gi发生/v时/qt，/w有可能/nz是因为/c页面/gi保存/gi在/pswap/nz区/n或者/c磁盘/gi文件/gi上/f造成/v的/ude1，/w练习二/nz需要/v利用/v页面/gi替换算法/gi解决/v这个/rz问题/gi。/w2/nz、/w思路/gi：/w页面/gi替换/v主要/b分为/v两/nz个/q方面/n，/w页面/gi换出/gi和/cc页面/gi换入/nz。/w页面/gi换入/nz主要/b在/pvmm/gi./nzc/nz中的/vdo/nz_/nzpgfault/nz(/nz)/nz函数/gi实现/gi；/w页面/gi换/v出/vf主要/b在/pswap/nz_/nzfifo/gi./nzc/nz中的/vswap/nz_/nzout/nz_/nzvistim/nz(/nz)/nz函数/gi实现/gi。/w在/p换入/nz时/qt，/w需要/v先/d检查/gi产生/v访问/gi异常/gi的/ude1地址/gi是否/v属于/v某个/rzvma/nz表示/v的/ude1合法/a虚拟地址/gi，/w并且/c保存/gi在/p硬盘/gi的/ude1swap/nz文件/gi中/f（/w对应/vi的/ude1pte/nz的/ude1高/a24/nz位/q不为/c0/nz）/w。/w如果/c满足/v以上/f亮点/n，/w则/d执行/vswap/nz_/nzin/nz(/nz)/nz函数/gi换入/nz页面/gi。/w换出/gi则/d相对/d简单/a，/w当/p申请/v空闲/gi页面/gi时/qt，/walloc/nz_/nzpages/nz(/nz)/nz函数/gi不能/v获得/v空闲页/nz，/w则/d直接/ad调用/giswap/nz_/nzout/nz(/nz)/nz函数/gi换/v出/vf不/d常用/a的/ude1页面/gi。/w3/nz、/w实现/gi：/w（/w一/nz）/w、/w页面/gi换入/nz的/ude1实现/gi（/w二/nz）/w、/w页面/gi换/v出/vf的/ude1关键/n代码/gififo/gi替换算法/gi会/v维护/gi一个/mq队列/gi，/w队列/gi按照/p页面/gi调用/gi的/ude1次序/gi排列/gi，/w越早/nz被/pbei加载/gi到/v内存/gi的/ude1页面/gi会/v越早/nz被/pbei换出/gi。/w下面/f几/d个/q关键/n函数/gi在/pswap/nz_/nzout/nz(/nz)/nz中/f被/pbei调用/gi。/w①/nz_/nzfifo/gi_/nzmap/nz_/nzswappable/nz(/nz)/nz函数/gi将/d最近/t被/pbei用/p到/v的/ude1页面/gi添加/gi到/v算法所/nz维护/gi的/ude1次序/gi队列②/nz_/nzfifo/gi_/nzswap/nz_/nzout/nz_/nzvictim/nz(/nz)/nz函数/gi是/vshi用来/v查询/gi哪个/ry页面/gi需要/v被/pbei换出/gi。/w /x结果/n部分/n截图/vn：/w