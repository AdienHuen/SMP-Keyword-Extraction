#poj /nz1741/nz(/nz1987/nz)/nz /x树/gi分治/gi（/w求/v距离/gi小于/v某/rz值/n的/ude1点对数/nz）/w
题意/n：/w给定/gi一/nz棵/q带权/nz无/v向/p树/gi，/w并/cc给定/gi一个/mq整数/gim/nz。/w求/v树上/s点/gi间/f最短路/gi不大/d于/pm/nz的/ude1点/gi对/p数量/n。/w(/nz1987/nz题意/n完全相同/nz，/w又/d重新/d写/v一/nz遍/qv熟练/a一下/m)/nz思路/gi：/w比较/gi明显/a的/ude1思路/gi是/vshi用/plca/nz来/vf做/v，/w但/c问题/gi是/vshi用/plca/nz的话/udh，/w当前/t问题/gi的/ude1查询/gi数量级/n为/pn/nz^/nz2/nz，/w所以/c不管/c使用/gi离线/nlca/nz还是/c在线/vnlca/nz都/d逃不过/vo/nz(/nzn/nz^/nz2/nz)/nz的/ude1复杂度/gi。/w经过/p学习/gi知道/v了/ule树/gi分治/gi这种/r东西/n。/w将/d无根树/nz转化成/l有/vyou根树/nz进行/vn观察/gi。/w满足条件/l的/ude1点/gi对/p有/vyou两/nz种/q情况/n：/w两/nz个/q点/gi的/ude1路径/gi横跨/v树根/n，/w两/nz个/q点/gi位于/v同一/b颗子/nz树/gi中/f。/w如果/c我们/rr已经/d知道/v了/ule此时/r所有/b点到根/nz的/ude1距离/gia/nz[/nzi/nz]/nz，/wa/nz[/nzx/nz]/nz  a/nz[/nzy/nz]/nz /x=/nz k/nz的/ude1(/nzx/nz,/nz y/nz)/nz对数/gi就是/v结果/n，/w这个/rz可以/v通过/p排序/gi之后/fo/nz(/nzn/nz)/nz的/ude1复杂度/gi求出/v。/w然后/c根据/p分治/gi的/ude1思想/gi，/w分别/d对/p所有/b的/ude1儿子/n求/v一/nz遍/qv即可/v，/w但是/c这/rzv会/v出现/v重复/gi的/ude1―/w―/w当前/t情况下/nz两/nz个/q点/gi位于/v一颗子/nz树/gi中/f，/w那么/c应该/v将/d其/rz减掉/v（/w显然/ad这/rzv两/nz个/q点/gi是/vshi满足/v题意/n的/ude1，/w为什么/ryv减掉/v呢/y？/w因为/c在/p对/p子树/gm进行/vn求解/gi的/ude1时候/n，/w会/v重新/d计算/gi）/w。/w在/p进行/vn分治/gi时/qt，/w为了/p避免/v树/gi退化/vi成/v一条链/nz而/cc导致/gi时间复杂度/gi变为/vo/nz(/nzn/nz^/nz2/nz)/nz，/w每次/r都/d找树/nz的/ude1重心/n，/w这样/rzv，/w所有/b的/ude1子树/gm规模/gi就/d会/v变/v的/ude1很小/a了/ule。/w时间复杂度/gio/nz(/nznlog/nz^/nz2/nzn/nz)/nz。/w树/gi的/ude1重心/n的/ude1算法/gi可以/v线性/gi求解/gi，/w关于/p树/gi的/ude1重心/n的/ude1定义/gi和/cc解法/gi可以/v参见/vpoj/gi1655。1987/nz：/w