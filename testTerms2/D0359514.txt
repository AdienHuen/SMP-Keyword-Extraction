#vb.net/gi机房收费系统/gi重构/gi―/w―/w存储过程/gi的/ude1使用/gi
 /x在/p敲写/nz七层/nz登陆/vi过程/gi中/f，/w接触/v了/ule存储过程/gi的/ude1概念/gi，/w但/c当时/t还/d没/d使用/gi。/w在/p正式/ad的/ude1重构/gi过程/gi中/f，/w一/nz点点/v添加/gi，/w将/d存储过程/gi也/d添加/gi到/v了/ule重构/gi中/f。/w才/d正式/ad了解/v了/ule存储过程/gi。/w /x首先/d【/w存储过程/gi的/ude1概念/gi】/w存储过程/giprocedure/nz是/vshi一/nz组/n为了/p完成/v特定/b功能/gi的/ude1sql语句/gi集合/gi，/w经/p编译/gi后/f存储/gi在/p数据库/gi中/f，/w用户/gi通过/p指定/v存储过程/gi的/ude1名称/n并/cc给出/v参数/gi来/vf执行/v。/w /x存储过程/gi中/f可以/v包含/v逻辑/n控制/vn语句/gi和/cc数据/gi操纵/gi语句/gi，/w它/rr可以/v接受/gi参数/gi、/w输出/gi参数/gi、/w返回/v单个/b或/c多/a个/q结果/n集/q以及/cc返回/v。/w【/w存储过程/gi的/ude1使用/gi】/w首先/d，/w打开/gi数据库/gi―/w―/w存储过程/gi右键/gi―/w新建/v存储过程/gi例如/v在/p机房收费系统/gi中/f注册/gi新/a用户/gi的/ude1存储过程/gi存储过程/gi名称/n为/p：/wpro/nz_/nzregister/nz调用/gi时/qt在/pd/nz层/gi【/w存储过程/gi的/ude1优点/gi】/w存储过程/gi允许/v标准/gi组件/gi式/k编程/gi  /x1/nz、/w存储过程/gi允许/v标准/gi式/k组件/gi编程/gi /x存储过程/gi创建/gi后/f可以/v在/p程序/gi中/f被/pbei多/a次/qv调用/gi执行/v，/w而/cc不必/d重新/d编写/gi该/rz存储过程/gi的/ude1sql语句/gi。/w而且/c数据库/gi专业/n人员/gi可以/v随时/d对/p存储过程/gi进行/vn修改/gi，/w但/c对/p应用程序/nz源代码/gi却/d毫无/v影响/gi，/w从而/c极大/a的/ude1提高/v了/ule程序/gi的/ude1可移植性/gi。/w /x2/nz、/w /x存储过程/gi能够/v实现/gi较快/d的/ude1执行/v速度/n  /x如果/c某/rz一操作/nz包含/v大量/m的/ude1t/nz-/nzsql语句/gi代码/gi，/w分别/d被/pbei多/a次/qv执行/v，/w那么/c存储过程/gi要/v比/p批处理/gi的/ude1执行/v速度快/nz得/ude3多/a。/w因为/c存储过程/gi是/vshi预/d编译/gi的/ude1，/w在/p首次/mq运行/gi一个/mq存储过程/gi时/qt，/w查询/gi优化器/nz对/p其/rz进行/vn分析/gi、/w优化/gi，/w并/cc给出/v最终/d被/pbei存在/v系统表/nz中的/v存储/gi计划/gi。/w而/cc批处理/gi的/ude1t/nz-/nzsql语句/gi每次/r运行/gi都/d需要/v预编/v译/v和/cc优化/gi，/w所以/c速度/n就要/d慢/a一/nz些/q。/w在/p机房收费系统/gi中/f，/w由于/p数据量/n和/cc用户/gi都/d比较/gi小/a，/w可能/v体会/gi不到/v批处理/gi和/cc存储过程/gi的/ude1区别/gi。/w当/p用户/gi较多/d数据量/n较大/d时/qt，/w此/rzs方法/gi的/ude1优点/gi较为/d明显/a。/w /x3/nz、/w /x存储过程/gi减轻/v网络流量/nz  /x对于/p同一个/b针对/gi数据库/gi对象/gi的/ude1操作/gi，/w如果/c这/rzv一/nz操作/gi所/usuo涉及/v到/v的/ude1t/nz-/nzsql语句/gi被/pbei组织/gi成/v一/nz存储过程/gi，/w那么/c当/p在/p客户/n机上/s调用/gi该/rz存储过程/gi时/qt，/w网络/gi中/f传递/v的/ude1只是/d该/rz调用/gi语句/gi，/w否则/c将/d会/v是/vshi多/a条/qsql语句/gi。/w从而/c减轻/v了/ule网络流量/nz，/w降低/v了/ule网络/gi负载/gi。/w此/rzs优点/gi也/d是/vshi当/p数据量/n较大/d时/qt可以/v明显/a体会出/n存储过程/gi的/ude1优势/gi。/w /x4/nz、/w /x存储过程/gi可/v被/pbei作为/p一种/nz安全/gi机制/gi来/vf充分利用/n  /x系统管理员/nnt可以/v对/p执行/v的/ude1某/rz一个/mq存储过程/gi进行/vn权限/gi限制/vn，/w从而/c能够/v实现/gi对/p某些/rz数据/gi访问/gi的/ude1限制/vn，/w避免/v非/b授权/v用户/gi对/p数据/gi的/ude1访问/gi，/w保证数据/n的/ude1安全/gi。/w