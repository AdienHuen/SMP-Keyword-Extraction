#【/w机器学习/gi算法/gi源码/gi阅读/gi】/w之/uzhiKNN/gi算法/gi
前言/gi：/w之前/f学/v过/uguo统计/gi学习/gi这/rzv门/n课/n，/w基本上/d是/vshi了解/v过/uguo主流/gi的/ude1机器学习/gi算法/gi。/w但是/c一直/d没有/v自己/rr从/p程序/gi的/ude1角度/n去/vf深入/ad理解/gi它们/rr。/w现在/t准备/v阅读/gi相关/vn算法/gi的/ude1实现/gi源码/gi来/vf进一步/d理解/gi这些/rz算法/gi。/w /x参考资料/nz：/wpython/gi《/w机器学习/gi实战/gi》/w                  c/nz+/nz+/nz     shark/nz开源库/nz源码/gi一/nz./nzknn/gi算法/gi原理/gi knn/nz算法/gi可以/v视为/v是/vshi最简单/nz的/ude1分类/gi算法/gi。/w它/rr是/vshi一种/nzlazy learning/nz，/w并不需要/l训练/gi出来/vf实际/n的/ude1数学模型/gm，/w甚至/d也/d可以/v认为/v这种/r算法/gi不/d需要/v训练/gi的/ude1过程/gi。/w假设/gi我们/rr的/ude1训练/gi集/q里面/f有/vyoux/nz1/nz,/nzx/nz2/nz,/nz…/w./nz,/nzxn/nz一共/dn/nz个/qm/nz维/b的/ude1训练样本/n，/w每个/r样本/gi都/d有/vyou对应/vi的/ude1标签/giy/nz1/nz,/nzy/nz2/nz…/w,/nzyn/nz。/w现在/t给定/gi测试/gi向量/git/nz,/nzt/nz也/d是/vshim/nz维/b的/ude1向量/gi，/w我们/rr需要/v做/v的/ude1就是/v判断/git/nz的/ude1类别/gi。/wknn/gi算法/gi首先/d定义/gi一种/nz距离/gi度量/v标准/gi来/vf度量/vt/nz和/ccxi/nz的/ude1远近/n程度/n，/w最简单/nz的/ude1度量/v标准/gi就是/v欧氏/nz距离/gi。/w接下来/vl，/w需要/v找出/v训练/gi集中/v与/cct/nz距离/gi最近/t的/ude1k/nz个/q训练样本/n，/w这/rzvk/nz个/q样本/gi各自/rr所属/n的/ude1类别/gi也/d是/vshi已知/nz的/ude1。/w最后/f，/w我们/rr选取/gi这/rzvk/nz个/q样本/gi中/f所属/n类别/gi最多/ad的/ude1类别/gi作为/pt/nz的/ude1类别/gi。/wknn/gi算法/gi基于/p非常/d朴素/a的/ude1事实/n：/w如果/c两/nz个/q样本/gi非常/d相似/a，/w那么/c它们/rr所属/n的/ude1类别/gi也/d应该/v基本相同/n。/wknn/gi算法/gi的/ude1优点/gi：/w简单/a，/w精度高/n knn/nz算法/gi的/ude1缺点/gi：/w计算/gi复杂度/gi高/a，/w空间/n复杂度/gi高/a，/w当/p训练样本/n数目/gi很大/d的/ude1时候/n难以实现/l。/w二/nz./nzknn/gi算法/gi的/ude1c++/gi实现/gi（/wshark/nz库/n源码/gi分析/gi）/w /x测试/gi源码/gi：/w寻找/vk/nz个/q近邻/gi的/ude1核心/n算法程序/gi：/wshark/nz库/n实现/gi的/ude1寻找/vk/nz近邻/gi算法/gi的/ude1复杂度/gi是/vshio/nz(/nzk/nz*/nzn/nz)/nz，/w每次/r需要/v遍历/gi整个/b训练/gi集/q，/w第一次/nz寻找/v距离/gi最小/a的/ude1样本/gi，/w第二次/nz寻找/v距离/gi第二小/nz的/ude1样本/gi，/w直至/v寻找/v出/vf距离第/nzk/nz小/a的/ude1样本/gi。/w想起/v之前/f写/v的/ude1博客/gi《/w【/wjuly/nz程序员/gi编程/gi艺术/n】/w之/uzhi最小/a的/ude1k/nz个数/n问题/gi》/w，/w可以/v采用/v最大/gm堆/gi的/ude1数据结构/gi，/w那样/rzv可以/v把/pba复杂度/gi优化/gi到/vo/nz(/nzn/nz*/nzlog k/nz)/nz。/w三/nz./nzknn/gi算法/gi的/ude1python/gi实现/gi（/w机器学习/gi实战/gi源码/gi）/wpython/gi实现/gi使用/gi了/ulenumpy/nz库/n，/w因此/c可以/v直接/ad使用/gi矩阵/gi进行/vn运算/gi，/w相比/vi于/pc++/gi的/ude1实现/gi要/v方便/a很/d多/a。/wpython/gi实现/gi中/f还/d对/p训练样本/n的/ude1特征/gi向/p量值/nz做/v了/ule一下/m归一化/gp，/w这/rzv也/d是/vshi很/d有/vyou意义/n的/ude1操作/gi：/w