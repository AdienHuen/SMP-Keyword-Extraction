#数据中心/gi存储/gi架构-刘新民/nz（/w数据中心/gi /x存储/gi）/w
数据中心/gi存储/gi架构/gi文/ng//nz刘新民/nr存储系统/gi是/vshi数据中心/giit/gi环境/n的/ude1核心/n基础架构/n，/w是/vshi数据中心/gi数据/gi访问/gi的/ude1最终/d承载体/n。/w存储/gi在/p云计算/gi、/w虚拟化/gi、/w大数据/gi等/udeng相关/vn技术/gi进入/v后/f已经/d发生/v了/ule巨大/a的/ude1改变/v，/w块/q存储/gi、/w文件/gi存储/gi、/w对象/gi存储/gi支撑/v起/vf多/a种/q数据类型/gi的/ude1读取/gi；/w集中式/n存储/gi已经/d不再/d是/vshi数据中心/gi的/ude1主流/gi存储/gi架构/gi，/w海量数据/gi的/ude1存储/gi访问/gi，/w需要/v扩展性/n、/w伸缩性/gi极强/d的/ude1分布式存储/gi架构/gi来/vf实现/gi。/w在/p新的/ait/gi发展/gi过程/gi中/f，/w数据中心/gi建设/gi已经/d进入/v云计算/gi时代/gi，/w企业/giit/gi存储/gi环境/n已经/d不能/v简单/a的/ude1从/p一般性/n业务/gi运营/gi需求/gi来/vf构建/gi云计算/gi的/ude1数据中心/gi存储/gi环境/n。/w云计算/gi数据中心/gi的/ude1建设/gi不是/c为了/p满足/v某/rz一个/mq业务/gi系统/gi的/ude1特殊/a目标/gi，/w是/vshi为了/p实现/gi所有/b业务/gi系统/gi在/p云平台/gi上/f能够/v实现/gi灵活/a的/ude1资源/gi调度/vn、/w良好/a的/ude1伸缩性/gi、/w业务/gi扩展/gi的/ude1弹性/n以及/cc快速/d交付性/nz。/w因此/c，/w是/vshi一种/nz自下而上/al的/ude1建设/gi模式/gi（/w如/v图/gi1/nz所示/nz）/w，/w基于/p云计算平台/gi的/ude1建设/gi先于/v应用系统/gi需求/gi，/w并/cc不再/d与/cc具体/a的/ude1业务/gi捆绑/gi，/w应用系统/gi的/ude1建设/gi、/w扩容/v、/w升级/vi主要/b以/p软件/gi为主/vi，/w硬件/gi物理/n资源/gi向/p资源/gi池/ng申请/v，/w存储系统/gi成为/v云数据中心/gi的/ude1可/v分配/gi、/w可/v调度/vn的/ude1资源/gi，/w在/p这种/r情况下/nz，/w有助于/v消除/v瓶颈/gi、/w提高/v处理速度/n，/w使得/vi业务/gi系统/gi稳定/an、/w高效/b、/w持久/a运行/gi。/w图/gi1/nz /x数据中心/gi的/ude1系统/gi建设/gi发展/gi1/nz数据中心/gi存储/gi架构/gi的/ude1演进/vn随着/p数据中心/gi从/p最初/d的/ude1孤立/a系统/gi企业级应用/gi，/w发展/gi到/v互联网/gi化/v阶段/gi的/ude1大规模/b云计算/gi服务/gi，/w其/rz存储/gi架构/gi也/d不断/d发展/gi（/w如/v图/gi2/nz所示/nz）/w。/w从/p满足/v关键/n系统/gi的/ude1性能/gi与/cc容量/gi需求/gi，/w到/v以/p虚拟化/gi架构/gi来/vf整合/gi数据中心/gi存储资源/n，/w提供/v按/p需/v的/ude1存储/gi服务/gi和/cc自动化/gi运维/gi，/w并/cc进一步/d向/p存储系统/gi的/ude1智能化/gi、/w敏捷/gi化/v演进/vn，/w应用/gi需求/gi的/ude1变化/gi是/vshi存储/gi架构/gi不断改进/l提升/gi的/ude1驱动力/n，/w竖井/n式/k、/w虚拟化/gi、/w云存储/gi三种/nz架构/gi并存/vi是/vshi当前/t现状/gi，/w软件/gi定义/gi存储/gi架构/gi的/ude1出现/v则/d是/vshi后/f云计算/gi时代/gi的/ude1存储/gi发展/gi阶段/gi。/w图/gi2/nz /x存储系统/gi系统架构/gi和/cc管理/gi演进/vn竖井/n式/k架构/gi对于/p早期/f的/ude1系统/gi，/w在/p主机/gi架构/gi下/f，/w数据/gi和/cc逻辑/n是/vshi一体/n的/ude1，/w采用/v面向/v过程/gi的/ude1设计/gi方法/gi，/w每个/r应用/gi是/vshi一个/mq孤立/a的/ude1系统/gi，/w维护/gi相对/d容易/ad，/w难于/vd相互/d集成/vn；/w客户机/nz//nz服务器架构/gi将/d逻辑/n与/cc数据/gi进行/vn了/ule分离/vi（/w不论/cc/nz//nzs/nz还是/cb/nz//nzs/nz模式/gi，/w本质/n都/d是/vshi客户机/nz//nz服务器架构/gi）/w，/w同样/d采用/v面向对象/gi的/ude1设计/gi方法/gi，/w每个/r应用/gi是/vshi一个/mq孤立/a的/ude1系统/gi，/w提供/v了/ule一定/b后台/gi集成/vn的/ude1能力/gi。/w这种/r架构/gi的/ude1存储/gi也/d随着/p系统/gi的/ude1建设/gi形成/v了/ule自身/rr的/ude1独立性/gi，/w业务/gi平台/gi的/ude1硬件/gi设备/gi按照/p规划/gi期内/f最大/gm用户数/n来/vf配置/gi，/w而/cc在/p业务/gi初期/f和/cc业务/gi发展/gi情况/n难/a预测/gi的/ude1情况下/nz，/w无法/v真实/a评估/gi存储/gi的/ude1规模/gi与/cc性能/gi要求/n，/w这/rzv往往/d会/v浪费/gi不/d少/a硬件/gi设备/gi资源/gi和/cc空间/n、/w动力/n等/udeng资源/gi，/w并且/c硬件资源/l不能/v灵活/a调度/vn。/w每个/r业务/gi上线/n都/d需要/v经过/p软件/gi选型/n、/w评估/gi资源/gi、/w硬件/gi选型/n、/w采购/vn和/cc实施/gi等/udeng环节/gi，/w业务/gi上线/n流程/gi长/a、/w时间跨度/nz大/a，/w不利于/v业务/gi发展/gi。/w即使/c是/vshi企业/gi数据中心/gi进入/v云计算/gi时代/gi，/w大量/m的/ude1应用/gi逐步/d向/p云/gi的/ude1环境/n迁移/gi，/w但/c因为/c某些/rz系统/gi独特/a的/ude1技术/gi要求/n，/w这种/r竖井/n式/k架构/gi也/d会/v长期存在/l。/w存储虚拟化/gi随着/p业务/gi发展/gi，/w数据中心/gi存储/gi不可避免/vl形成/v大量/m的/ude1异构/gi环境/n，/w标准化/vn的/ude1管理/gi流程/gi难以/d实施/gi。/w存储虚拟化/gi架构/gi实现/gi对/p不同/a结构/gi的/ude1存储设备/nz进行/vn集中化/vn管理/gi，/w统一/vn整合/gi形成/v一个/mq存储池/nz，/w向/p服务器/gi层/gi屏蔽/v存储设备/nz硬件/gi的/ude1特殊性/n，/w虚拟化/gi出/vf统一/vn的/ude1逻辑/n特性/gi，/w从而/c实现/gi了/ule存储系统/gi集中/v、/w统一/vn而/cc又/d方便/a的/ude1管理/gi。/w使得/vi存储池/nz中的/v所有/b存储/gi卷/q都/d拥有/v相同/a的/ude1属性/gi，/w如/v性能/gi、/w冗余/n特性/gi、/w备份/gi需求/gi或/c成本/n，/w并/cc实现/gi自动化/gi（/w如/vlun/nz管理/gi）/w以及/cc基于/p策略/gi的/ude1集中/v存储管理/gi。/w同时/c，/w存储资源/n的/ude1自动化/gi管理/gi为/p用户/gi提供/v更高/d层次/n策略/gi的/ude1选择/gi。/w在/p存储池/nz中/f可以/v定义/gi多/a种/q存储/gi工具/gi来/vf代表/nnt不同/a业务/gi领域/gi或/c存储用户/n的/ude1不同/a服务/gi等级/n。/w另外/c，/w还/d允许/v用户/gi以/p单元/n的/ude1方式/n管理/gi每/rz一/nz存储/gi池/ng内部/f的/ude1存储资源/n，/w根据/p需要/v添加/gi、/w删除/gi或/c改变/v，/w同时/c保持/v对/p应用服务器/gi业务/gi系统/gi的/ude1透明性/n。/w基于/p策略/gi的/ude1存储虚拟化/gi能够/v管理/gi整个/b存储/gi基础/gi机构/n，/w保持/v合理/a分配/gi存储资源/n，/w高/a优先级/n的/ude1应用/gi有/vyou更高/d的/ude1存储/gi优先级/n，/w使用性能/n最好/d的/ude1存储/gi，/w低优先级/l的/ude1应用/gi使用/gi便宜/a的/ude1存储/gi。/w云/gi存储架/nz构云/nz存储/gi架构/gi伴随/v着/uzhe大规模/b云计算/gi的/ude1数据/gi时代/gi的/ude1到来/gi，/w将/d存储/gi作为/p云/gi的/ude1服务/gi提供/v，/w不论是/c企业/gi私有云/nz还是/c公有云/gi的/ude1存储/gi，/w都/d着重于/n大量/m存储/gi数据/gi的/ude1创建/gi和/cc分布/vi，/w并/cc关注/v快速/d通过/p云/gi获得/v数据/gi的/ude1访问/gi。/w云存储/gi架构/gi需要/v支持/v大规模/b的/ude1数据/gi负载/gi的/ude1存储/gi、/w备份/gi、/w迁移/gi、/w传输/gi，/w同时/c要求/n巨大/a的/ude1成本/n、/w性能/gi和/cc管理/gi优势/gi。/w云存储/gi的/ude1技术/gi部署/gi，/w通过/p集群/gi应用/gi或/c分布式文件系统/nz等/udeng功能/gi，/w网络/gi中/f大量/m各种/rz不同/a类型/gi的/ude1存储设备/nz通过/p应用软件/gi集合起来/l协同工作/n，/w共同/d对外/vn提供数据/n存储/gi和/cc业务/gi访问/gi功能/gi的/ude1一个/mq系统/gi，/w保证数据/n的/ude1安全性/gi，/w并/cc节约/v存储空间/gi。/w在/p大规模/b系统/gi支撑/v上/f，/w分布式文件系统/nz、/w分布式/gi对象/gi存储/gi等/udeng技术/gi，/w为/p云存储/gi的/ude1各种/rz应用/gi提供/v了/ule高度/d可/v伸缩/vn、/w可扩展/nz和/cc极大/a的/ude1弹性/n支撑/v和/cc强大/a的/ude1数据/gi访问/gi性能/gi，/w并且/c因为/c这些/rz分布式/gi技术/gi对/p标准化/vn硬件/gi的/ude1支持/v，/w使得/vi大规模/b云存储/gi得以/v低成本/nz的/ude1建设/gi和/cc运维/gi。/w云存储/gi不是/c要/v取代/v现有/v的/ude1盘阵/nz，/w而是/c为了/p应付/v高速成长/n的/ude1数据量/n与/cc带宽/n而/cc产生/v的/ude1新形态/n存储系统/gi，/w因此/c云存储/gi在/p构建/gi时/qt重点/n考虑/v的/ude1三点/nz：/w扩容/v简便/a、/w性能/gi易于/vd增长/gi、/w管理/gi简易/a。/w软件/gi定义/gi存储/gi软件/gi定义/gi存储/gi当前/t还/d未有/v确切/a的/ude1定义/gi，/w但/c软件/gi定义/gi存储/gi代表/nnt了/ule一种/nz趋势/gi，/w即/v存储/gi架构/gi中/f软件/gi和/cc硬件/gi的/ude1分离/vi，/w也/d就是/v数据/gi层/gi和/cc控制/vn层/gi的/ude1分离/vi。/w对于/p数据中心/gi用户/gi而言/uls，/w通过/p软件/gi来/vf实现/gi对/p存储资源/n的/ude1管理/gi和/cc调度/vn，/w如/v灵活/a的/ude1卷/q迁移/gi等/udeng而/cc无需/v考虑/v硬件/gi设备/gi本身/rz。/w通过/p软件/gi定义/gi存储/gi实现/gi存储资源/n的/ude1虚拟化/gi、/w抽象化/nz、/w自动化/gi，/w能够/v完整/a的/ude1实现/gi数据中心/gi存储系统/gi的/ude1部署/gi、/w管理/gi、/w监控/gi、/w调整/vn等/udeng多/a个/q要求/n，/w使得/vi存储系统/gi具备/v灵活/a、/w自由/a和/cc高/a可用/v等/udeng特点/n。/w传统/n存储/gi的/ude1虚拟化/gi、/w自动化/gi都/d是/vshi由/p专用/gi的/ude1存储设备/nz来/vf实现/gi，/w许多厂商/nz虚拟化/gi存储/gi都/d要/v使用/gi自己/rr定制/n的/ude1设备/gi，/w或者/c是/vshi在/p特定/b服务器/gi上/f加载/gi的/ude1一/nz款/q软件/gi来/vf支持/v。/w软件/gi定义/gi存储/gi将/d存储/gi服务/gi从/p存储系统/gi中/f抽象/gi出来/vf，/w且/c可/v同时/c向/p机械/n硬盘/gi及/cc固态/n硬盘/gi提供/v存储/gi服务/gi，/w软件/gi定义/gi存储/gi消除/v硬件/gi设备/gi的/ude1限制/vn，/w采用/v开放/gi的/ude1存储/gi架构/gi，/w提供/v存储/gi的/ude1性能/gi、/w可管理性/gi，/w增强/v存储系统/gi的/ude1智能性/n和/cc敏捷/gi的/ude1服务/gi能力/gi，/w同时/c软件/gi定义/gi存储/gi也/d以/p分布式/gi技术/gi如/v分布式/gi文件/gi存储/gi、/w对象/gi存储/gi等/udeng大规模/b可扩展/nz架构/gi为/p数据/gi基础/gi，/w对/p上/f支持/v灵活/a的/ude1控制/vn管理/gi，/w这/rzv将/d是/vshi存储/gi领域/gi发展/gi的/ude1大趋势/nz。/w2/nz数据中心/gi存储/gi的/ude1技术/gi架构/gi2.1/nz数据类型/gi数据中心/gi的/ude1存储/gi数据类型/gi发生/v了/ule很大/d的/ude1变化/gi，/w按照/p结构化/n程度/n来/vf分/qt，/w可以/v大致/d分为/v以下/f三种/nz。/w?/nz /x结构化/n数据/gi的/ude1存储/gi及/cc应用/gi。/w这/rzv是/vshi一种/nz用户/gi定义/gi的/ude1数据类型/gi，/w它/rr包含/v了/ule一系列/b的/ude1属性/gi，/w每/rz一个/mq属性/gi都/d有/vyou一个/mq数据类型/gi，/w存储/gi在/p关系数据库/gi里/f。/w一般/ad的/ude1业务/gi系统/gi都/d有/vyou大量/m的/ude1结构化/n数据/gi，/w一般/ad存储/gi在/poracle/gi或/cmysql/gi的/ude1等/udeng的/ude1关系型数据库/gi中/f，/w在/p企业级/nz数据中心/gi，/w一般/ad在/p集中/v存储/gi架构/gi中/f保存/gi，/w或/c成为/v主存储/nz系统/gi，/w以/p块/q存储/gi访问/gi为主/vi。/w?/nz /x非结构化/gi数据/gi的/ude1存储/gi及/cc应用/gi。/w相对于/nz结构化/n数据/gi而言/uls，/w不方便/nz用/p数据库/gi二维逻辑/nz表/n来/vf表现/v的/ude1数据/gi即/v称为/v非结构化/gi数据/gi，/w包括/v所有/b式/k的/ude1办公/gi文档/gi、/w文本/gi、/w图片/gi、/wxml/nz、/whtml/gi、/w各类/r报表/gi、/w图像/gi和/cc音频/gi//nz视频/gi信息/gi等等/udeng，/w分布式文件系统/nz是/vshi实现/gi非结构化/gi数据存储/gi的/ude1主要/b技术/gi。/w?/nz /x半结构/nz化/v数据/gi的/ude1存储/gi及/cc应用/gi。/w介于/v完全/ad结构化/n数据/gi（/w如/v关系型数据库/gi、/w面向对象/gi数据库/gi中的/v数据/gi）/w和/cc完全/ad无/v结构/gi的/ude1数据/gi（/w如/v声音/gi、/w图像文件/nz等/udeng）/w之间/f的/ude1数据/gi，/w半结构/nz化/v数据模型/gg具有/v一定/b的/ude1结构性/n，/w但/c较之/p传统/n的/ude1关系/gi和/cc面向对象/gi的/ude1模型/gi更为/d灵活/a。/w半结构/nz数据模型/gg完全/ad不/d基于/p传统/n数据库/gi模式/gi的/ude1严/a概念/gi，/w这些/rz模型/gi中的/v数据/gi都/d是/vshi自描述/n的/ude1。/w由于/p半结构/nz化/v数据/gi没有/v严/a的/ude1语义/n定义/gi，/w所以/c不适/a合用/v传统/n的/ude1关系型数据库/gi进行/vn存储/gi，/w适合/v存储/gi这类/r数据/gi的/ude1数据库/gi被称作/n“/wnosql/gi”/w数据库/gi。/w2.2/nz块/q、/w文件/gi、/w对象/gi块/q存储/gi对于/p存储系统/gi，/w块/q读写/gi一般/ad是/vshi在/p存储介质/nz上/f的/ude1数据/gi概念/gi，/w对于/p磁盘/gi来说/uls，/w块/q数据/gi的/ude1存储单元/gm是/vshi一个/mq或/c多/a个/q磁盘/gi扇区/gi。/w因此/c块级/nz数据/gi的/ude1读写/gi，/w是/vshi面向/v最底层/n的/ude1物理层/gi的/ude1，/w数据/gi操作/gi基于/p起始/gi扇区/gi编号/gi、/w操作码/gi(/nz读/v、/w写/v等/udeng)/nz、/w连续/gi扇区/gi数量/n等/udeng，/w块/q数据/gi访问/gi接口/gi是/vshiscsi/nz接口/gi。/w有/vyou两/nz种/q常用/a的/ude1两/nz种/q块/q存储/gi方式/n。/w?/nz das/nz（/wdirect attach storage/nz）/w。/w是/vshi直接/ad连接/gi于/p主机/gi服务器/gi的/ude1一种/nz储存/gi方式/n，/w每/rz一/nz台/q主机/gi服务器/gi有/vyou独立/a的/ude1储存/gi设备/gi，/w每/rz台/q主机/gi服务器/gi的/ude1储存/gi设备/gi无法/v互通/v，/w需要/v跨/v主机/gi存取/gi资料/gi时/qt，/w必须/d经过/p相对/d复杂/a的/ude1设定/v，/w若/c主机/gi服务器/gi分属/v不同/a的/ude1操作系统/gi，/w要/v存取/gi彼此/rr的/ude1数据/gi，/w更是/d复杂/a，/w有些/rz系统/gi甚至/d不能/v存取/gi。/w通常/d用/p在/p单一/gi网络/gi环境/n下/f且/c数据交换/nz量/n不大/d，/w性能/gi要求/n不/d高/a的/ude1环境/n下/f，/w是/vshi早期/f的/ude1技术/gi实现/gi。/w?/nz san/nz（/wstorage area network/nz）/w。/w是/vshi一种/nz用/p高速/b网络/gi联接/v主机/gi服务器/gi与/cc存储设备/nz的/ude1一种/nz储存/gi方式/n，/w存储系统/gi会/v位于/v主机/gi群/ng的/ude1后端/f，/w它/rr使用/gi高速/bi/nz//nzo/nz网络/gi联结/v方式/n，/w以/pfc/nz、/wiscsi/nz、/wfcoe/nz为/p当前/t主流/gi形式/gi。/w一般而言/vl，/wsan/gi应用/gi在/p对/p网络/gi速度/n要求/n高/a、/w对/p数据/gi的/ude1可靠性/gi和/cc安全性/gi要求/n高/a、/w对/p数据共享/gi的/ude1性能/gi要求/n高/a的/ude1应用环境/l中/f，/w特点/n是/vshi代价/gi高/a，/w性能/gi好/a。/w它/rr采用/vscsi /nz块/qi/nz//nzo/nz的/ude1命令集/n，/w在/psan/gi网络/gi级/q的/ude1数据/gi访问/gi提供/v高性能/gi的/ude1随机/bi/nz//nzo/nz和/cc数据/gi吞吐率/nz，/w具有/v高带宽/nz、/w低/a延迟/v的/ude1优势/gi，/w但是/c由于/psan/gi系统/gi的/ude1价/n较高/ad，/w且/c不具备/v大规模/b可扩展性/gi，/w不能/v满足/v大型/b云计算/gi数据中心/gi的/ude1存储/gi需求/gi。/w文件/gi存储/gi对于/p文件/gi，/w是/vshi“/w按/p名/q存取/gi”/w的/ude1，/w为了/p区分/v磁盘/gi上/f各个/rz不同/a的/ude1文件/gi，/w需要/v给/p每个/r文件/gi取一个/nz确定/v的/ude1名字/n，/w称为/v文件名/gi，/w它/rr用来/v表示/v磁盘/gi上/f的/ude1文件/gi，/w以/p便于/v在/p磁盘/gi上/f能够/v“/w按/p名/q查找/gi”/w这些/rz文件/gi。/w文件/gi的/ude1数据/gi操作/gi基于/p文件名/gi、/w偏移量/gi、/w读/v写字/vi节数/n等/udeng，/w但是/c文件/gi本身/rz并/cc无/v文件/gi自身/rr的/ude1属性/gi、/w元数据/gi信息/gi。/w基于/p对/p不同/a环境/n的/ude1文件/gi存储/gi发展/gi了/ule多种形式/nz的/ude1文件系统/gi（/w如/v表/n1/nz所示/nz）/w。/w表/n1/nz /x几/d种/q文件系统/gi对象/gi存储/gi对象/gi是/vshi自/p完备/a的/ude1，/w包含/v元数据/gi、/w数据/gi和/cc属性/gi，/w可以/v进行/vn自我管理/l，/w对象/gi本身/rz是/vshi平等/a的/ude1。/w也/d就是说/c，/w对象/gi分布/vi在/p一个/mq平坦/a的/ude1空间/n中/f，/w而非/c文件系统/gi那样/rzv的/ude1树/gi状/ng逻辑结构/gi之中/f，/w对象/gi存储/gi以/pid/nz为基础/nz，/w根据/pid/nz可以/v直接/ad访问/gi数据/gi，/w核心/n是/vshi将/d数据通路/gi（/w数据/gi读/v或/c写/v）/w和/cc控制/vn通路/n（/w元数据/gi）/w分离/vi，/w并且/c基于/p对象/gi存储设备/nz（/wobject/nz-/nzbased storage device/nz，/wosd/nz）/w构建/gi存储系统/gi，/w每个/r对象/gi存储设备/nz具有/v一定/b的/ude1智能/gi，/w能够/v自动/d管理/gi其/rz上/f的/ude1数据分布/n。/w典型/n代表/nnt：/wswift/nz、/wceph/nz从/p设备/gi级别/n看/v块/q、/w文件/gi、/w对象/gi存储/gi（/w如/v表/n2/nz所示/nz）/w表/n2/nz块/q、/w文件/gi、/w对象/gi存储/gi的/ude1设备/gi级/q访问/gi比较/gi2.3/nz主/ag存储/gi架构/gi主/ag存储/gi是/vshi数据中心/gi的/ude1重要/a存储系统/gi，/w通常/d称为/vtier/nz1/nz存储/gi，/w用于/v存储/gi活动/gi数据/gi（/w经常/d需要/v访问/gi的/ude1数据/gi）/w以及/cc要求/n高性能/gi、/w低/a延迟/v、/w高可用性/n的/ude1数据/gi。/w主/ag存储/gi通常/d用于/v支撑/v数据中心/gi关键/n任务/gi程序/gi（/w如/v数据库/gi、/w电子邮件/gi和/cc事务处理/nz）/w。/w大/a多数/a重要/a程序/gi采用/v随机/b数据/gi访问/gi模式/gi，/w具有/v不同/a的/ude1访问/gi要求/n，/w但是/c都/d能/v产生/v大量/m数据/gi，/w企业/gi可以/v利用/v这些/rz数据/gi完成/v业务/gi。/w即使/c在/p虚拟/gi领域/gi中/f出现/v越来越/d多/a的/ude1新的/a数据/gi存储技术/nz，/w传统/n的/ude1主/ag存储系统/gi仍然/d普遍/ad。/wdas/nz是/vshi最早/d的/ude1主/ag存储/gi架构/gi，/w但/csan/gi已经/d成为/v当前/t使用/gi最/d广泛/a、/w也/d最为/d主流/gi的/ude1存储/gi架构/gi。/w而/ccnas/gi则/d在/p数据中心/gi用于/v文件共享/gi应用/gi，/w并且/c也/d在后/v端/v采用/v了/ulesan/gi的/ude1扩展/gi。/w在/p数据中心/gi领域/gi，/w绝大/nz多数/a厂商/gi也/d均/d以/psan/gi架构/gi来/vf部署/gi面向/v高级/a用户/gi的/ude1主/ag存储/gi解决方案/gi，/w以及/cc在/p此/rzs基础上/nz相关/vn的/ude1容灾/gi备份/gi方案/gi和/cc存储虚拟化/gi方案/gi（/w如/v图/gi3/nz所示/nz）/w。/w图/gi3/nz /x数据中心/gi主/ag存储/gi架构/gisan/gi的/ude1特点/n是/vshi性能/gi高/a、/w稳定性/n强/a、/w价高/n。/w在/p一些/m需要/v集中/v存储/gi的/ude1数据库/gi等/udeng实时/n服务/gi要求/n高/a的/ude1重要/a应用领域/l，/w依然/d是/vshi当前/t的/ude1主流/gi的/ude1技术/gi，/w在/p存储/gi应用/gi中/f，/w需要/v集中/v存储/gi的/ude1高端/nz应用/gi由/psan/gi来/vf承担/v，/w基于/p文件/gi的/ude1小规模/d应用/gi由/pnas/gi承担/v更/d合适/a，/w使得/visan/gi与/ccnas/gi成为/v互补/gi存储/gi架构/gi出现/v。/w最初/d的/ude1数据中心/gi，/w大部分/n数据/gi都/d是/vshi主数据/gi。/w随着/p数据/gi的/ude1存在/v时间/gi增长/gi，/w大量/m数据/gi会/v通常/d移动/vn到/v次级/b和/cc三级/gi存储/gi。/w因此/c，/w随着/p存储/gi各/rz方面/n技术/gi发展/gi和/cc业务/gi的/ude1成熟/a，/w数据中心/gi逐步/d开始/v寻求/v能够/v减少/v主/ag存储/gi的/ude1途径/n，/w以/p充分利用/n容量/gi，/w降低/v整个/b数据生命周期/gi的/ude1成本/n。/w2.4/nz分布式/gi文件/gi存储/gi架构/gi分布式文件系统/nz主要/b的/ude1功能/gi是/vshi用于/v存储/gi文档/gi、/w图像/gi、/w视频/gi之类/rz的/ude1非结构化/gi数据/gi，/w该/rz系统/gi建立/gi在/p网络/gi之上/f的/ude1，/w以/p全局/n方式/n管理系统/gi资源/gi，/w它/rr可以/v任意/d调度/vn网络/gi中的/v存储资源/n，/w并且/c调度/vn过程/gi是/vshi“/w透明/a”/w的/ude1。/w分布式存储/gi系统/gi采用/v可扩展/nz的/ude1系统结构/gi，/w利用/v多/a台/q存储/gi服务器/gi分担/gi存储/gi负荷/n，/w利用/v位置/gi服务器/gi定位/gi存储/gi信息/gi，/w不但/c提高/v了/ule系统/gi的/ude1可靠性/gi、/w可用性/gi和/cc存取/gi效率/gi，/w还/d易于/vd扩展/gi。/w以/p高性能/gi、/w高容量/n为/p主要/b特性/gi的/ude1分布式存储/gi系统/gi，/w一般/ad满足/v以下/f四个/nz条件/n：/w?/nz /x应用于/v网络/gi环境/n中/f；/w?/nz /x单个/b文件/gi数据分布/n存放在/v不同/a的/ude1节点/gi上/f；/w?/nz /x支持/v多/a个/q终端/gi多/a个/q进程/gi并发/gi存取/gi；/w?/nz /x提供/v统一/vn的/ude1目录/gi空间/n和/cc访问/gi名称/n。/whdfs/gi（/whadoop distributed file system/nz）/w是/vshi开源项目/gihadoop/gi的/ude1家族/gi成员/nnt，/w是/vshi谷歌/ntc文件系统/gigooglefs/nz（/wgoogle file system/nz）/w的/ude1开源/gi实现/gi，/w以下/f仅/d简单/a介绍/gihdfs/gi工作/gi模式/gi。/whdfs/gi被/pbei设计/gi成/v适合/v运行/gi在/p通用/gi硬件/gi上/f的/ude1分布式文件系统/nz，/w是/vshi一个/mq高度/d容错性/nz的/ude1系统/gi，/w适合/v部署/gi在/p廉价/a的/ude1机器/gi上/f。/whdfs/gi能/v提供/v高/a吞吐量/gi的/ude1数据/gi访问/gi，/w非常适合/i大规模/b数据/gi集/q上/f的/ude1非结构化/gi数据/gi、/w半结构/nz化/v应用/gi。/w运行/gi在/phdfs/gi之上/f的/ude1程序/gi有/vyou很大/d量/n的/ude1数据/gi集/q，/w典型/n的/ude1hdfs/gi文件大小/gi是/vshigb/nz到/vtb/nz的/ude1级别/n，/w因此/c，/whdfs/gi被/pbei调整/vn成/v支持/v大/a文件/gi。/w一个/mqhdfs/gi集群/gi是/vshi有/vyou一个/mqnamenode/gi和/cc一定/b数目/gi的/ude1datanode/gi组成/gi（/w如/v图/gi4/nz所示/nz）/w：/w?/nz namenode/nz（/w名称/n节点/gi）/w是/vshi一个/mq或/c一/nz组/n中心/gi服务器/gi，/w是/vshihdfs/gi的/ude1中枢/n，/w负责管理/n文件系统/gi的/ude1目录/gi名字/n空间信息/nz（/wnamespace/nz）/w和/cc客户端/gi对/p文件/gi的/ude1访问/gi，/w并且/c管理/gi所有/b的/ude1datanode/gi；/w?/nz datanode/nz（/w数据/gi节点/gi）/w在/phdfs/gi中/f负责管理/n本/rz节点/gi上/f附带/v的/ude1存储/giblock/nz（/w数据/gi块/q）/w。/w在/phdfs/gi内部/f，/w文件/gi不是/c放在/v一块/s磁盘/gi上/f，/w一个/mq文件/gi其实/d分成/vi多/a个/qblock/nz（/w数据/gi块/q）/w，/w这些/rzblock/nz存储/gi分散/a在/pdatanode/gi组成/gi的/ude1集群/gi中/f，/wnamenode/gi记录/giblock/nz对应/vi在/p不同/a的/ude1datanode/gi上/f的/ude1映射/gi关系/gi。/wnamenode/gi接受/gi客户端/gi的/ude1元数据/gi请求/gi，/w然后/c对/pdatanode/gi发出/vblock ops/nz（/w块/q操作/gi）/w指令/gi，/w文件/gi的/ude1创建/gi、/w删除/gi和/cc复制/gi操作/gi，/w同时/c决定/vblock/nz到/v具体/adatanode/gi节点/gi的/ude1映射/gi。/wdatanode/gi在/pnamenode/gi的/ude1管理/gi下/f进行/vnblock/nz的/ude1创建/gi、/w删除/gi和/cc复制/gi。/w图/gi4/nz hdfs/nz经典/gi体系/gi架构/gi图示/vhdfs/gi可靠性/gi和/cc性能/gi主要/b通过/p数据块/nz的/ude1副本/n来/vf实现/gi，/w并且/chdfs/gi采用/v一种/nz称之为/vrack/nz-/nzaware/nz（/w机架/n感知/gi）/w的/ude1策略/gi来/vf改进/gi数据/gi的/ude1可靠性/gi、/w有效性/gi和/cc网络带宽/gi的/ude1利用/v。/w在/p通常/d副本/n数/n为/p3/nz的/ude1情况下/nz，/whdfs/gi的/ude1策略/gi将/d一个/mq副本/n存放在/v本地/gi机架/n上/f，/w一个/mq副本/n放在/v同一个/b机架/n上/f的/ude1另一个/nz节点/gi，/w最后/f一个/mq副本/n放在/v不同/a机架/n上/f的/ude1一个/mq节点/gi。/w在/p读取/gi时/qt，/w为了/p降低/v整体/n的/ude1带宽/n消耗/gi和/cc读/v延时/v，/w如果/c客户端/gi同一个/b机架/n上有/v一个/mq副本/n，/w那么/c就读/vi该/rz副本/n。/whdfs/gi依然/d是/vshi主从/gi结构/gi，/wnamenode/gi成为/v整个/b系统/gi的/ude1瓶颈/gi和/cc关键/n故障/gi点/gi，/w因此/c，/w众多/a使用/gi分布式文件系统/nz的/ude1用户/gi均/d在/p此/rzs基础上/nz不断完善/l其/rz高可用性/n，/w比如/v发展/gi出/vf无/v中心/gi存储/gi架构/gi。/w2.5/nz分布式/gi对象/gi存储/gi架构/gi在/p对象/gi存储/gi中/f，/w存储/gi的/ude1不仅/c是/vshi数据/gi，/w还有/v与/cc丰富/a的/ude1数据/gi相关/vn的/ude1属性/gi信息/gi。/w系统/gi会/v给/p每/rz一个/mq对象/gi分配/gi一个/mq唯一/b的/ude1oid/nz（/wobject id/nz）/w。/w对象/gi本身/rz是/vshi平等/a的/ude1，/w所有/b的/ude1oid/nz都/d属于/v一个/mq平坦/a的/ude1地址/gi空间/n，/w而/cc并非/v文件系统/gi那样/rzv的/ude1树/gi状/ng逻辑结构/gi。/w对象/gi存储空间/gi访问/gi对象/gi只/d通过/p一个/mq唯一/b的/ude1oid/nz标识/n即可/v，/w不/d需要/v复杂/a的/ude1路径/gi结构/gi，/w没有/v“/w路径/gi”/w他/rr“/w文件/gi夹”/nz的/ude1概念/gi。/w对象/gi存储/gi架构/gi有/vyou以下/f组成/gi部分/n。/w对象/gi对象/gi是/vshi系统/gi中/f数据存储/gi的/ude1基本单位/gm。/w一个/mq对象/gi实际上/d就是/v文件/gi的/ude1数据/gi和/cc一/nz组/n属性/gi信息/gi（/wmeta data/nz）/w的/ude1组合/gi（/w如/v图/gi5/nz所示/nz）/w，/w这些/rz属性/gi信息/gi可以/v定义/gi基于/p文件/gi的/ude1raid/gi参数/gi、/w数据分布/n和/cc服务质量/gi等/udeng；/w而/cc传统/n的/ude1存储系统/gi中用/a文件/gi或/c块/q作为/p基本/a的/ude1存储/gi单位/n，/w在/p块/q存储系统/gi中/f还/d需要/v始终/d追踪/gi系统/gi中/f每个/r块/q的/ude1属性/gi，/w对象/gi通过/p与/cc存储系统/gi通信/gi维护/gi自己/rr的/ude1属性/gi。/w在/p存储设备/nz中/f，/w所有/b对象/gi都/d有/vyou一个/mq对象/gi标识/n，/w通过/p对象/gi标识/n命令/gi访问/gi该/rz对象/gi。/w通常/d有/vyou多种类型/n的/ude1对象/gi，/w存储设备/nz上/f的/ude1根/n对象/gi标识/n存储设备/nz和/cc该/rz设备/gi的/ude1各种/rz属性/gi，/w组/n对象/gi是/vshi存储设备/nz上/f共享资源/nz管理策略/n的/ude1对象/gi集合/gi等/udeng。/w图/gi5/nz /x对象/gi存储/gi数据/gi对象/gi存储设备/nz（/wosd/nz，/wobject storage device/nz）/wosd/nz有/vyou自己/rr的/ude1cpu/gi、/w内存/gi、/w网络/gi和/cc磁盘/gi系统/gi，/w和/cc块/q设备/gi的/ude1区别/gi不/d在于/v存储介质/nz，/w而/cc在于/v两者/rzv提供/v的/ude1访问/gi接口/gi。/wosd/nz的/ude1主要/b功能/gi包括/v数据存储/gi和/cc安全/gi访问/gi，/w目前/t国际上/nz通常/d采用/v标准化/vn计算/gi单元/n结构/gi实现/gi对象/gi存储设备/nz。/wosd/nz执行/v从/p对象/gi到/v块/q的/ude1映射/gi，/w这个/rz动作/gi允许/v本地/gi实体/n以/p最佳/z方式/n决定/v怎样/ryv存储一个/nz对象/gi，/wosd/nz存储/gi节点/gi不仅/c具备/v存储/gi功能/gi，/w还包括/nz智能化/gi的/ude1高级/a能力/gi。/w传统/n的/ude1存储/gi驱动/gi只是/d作为/ptarget/gi响应/v客户端/gi的/ude1i/nz//nzo/nz请求/gi，/w而/cc对象/gi存储设备/nz是/vshi智能设备/gi，/w它/rr能/v同时/c执行/vtarget/gi和/ccinitiator/nz的/ude1功能/gi，/w支持/v与/cc其他/rzv对象/gi存储设备/nz的/ude1通信/gi和/cc协作/gi，/w如/v数据/gi分配/gi、/w复制/gi与/cc恢复/gi。/w元数据/gi服务器/gi（/wmds /nz，/wmetadata server/nz）/w元数据/gi服务器/gi的/ude1工作/gi就是/v管理文件/n系统/gi的/ude1名称/n空间/n、/w控制/vn客户端/gi与/ccosd/nz对象/gi的/ude1交互/gi，/w缓存/gi和/cc同步/gi分布式/gi元数据/gi。/w虽然/c元数据/gi和/cc数据/gi两者/rzv都/d存储/gi在/p对象/gi存储/gi集群/gi，/w但/c两者/rzv分别/d管理/gi，/w支持/v可扩展性/gi。/w对象/gi存储系统/gi的/ude1客户端/giclient/nz为了/p有效/gi支持/vclient/nz支持/v访问/giosd/nz上/f的/ude1对象/gi，/w需要/v在/p计算/gi节点/gi实现/gi对象/gi存储系统/gi的/ude1client/nz，/w通常/d提供/vposix/nz文件系统/gi接口/gi，/w允许/v应用程序/nz像/v执行/v标准/gi的/ude1文件系统/gi操作/gi一样/uyy。/w在/p客户端/gi，/w用户/gi使用/gi文件系统/gi是/vshi透明/a的/ude1，/wlinux/gi通过/p内核/gi虚拟/gi文件系统/gi交换/gi(/nzvfs/nz)/nz来/vf进行/vn底层/n的/ude1操作/gi访问/gi。/w终端用户/gi访问/gi大容量/n的/ude1存储系统/gi，/w无需/v知道/v下面/f聚合/gi成大/a容量/gi存储池/nz的/ude1元数据/gi服务器/gi、/w监视器/n、/w独立/a的/ude1对象/gi存储设备/nz。/w文件系统/gi的/ude1智能化/gi处理/vn分布/vi在/p节点/gi上/f，/w这/rzv简化/gi了/ule客户端/gi接口/gi，/w可以/v支撑/v大规模/b动态/gi扩展/gi能力/gi。/w对象/gi存储/gi构筑/v在/p标准/gi硬件/gi存储/gi基础设施/gi之上/f，/w无需/v采用/vraid/gi（/w磁盘/gi冗余/n阵列/gi）/w，/w通过/p在/p软件/gi层面/n引入/v一致性/gi散列/nz技术/gi和/cc数据/gi冗余/n性/ng，/w牺牲/v一定/b程度/n的/ude1数据/gi一致性/gi来/vf达到/v高可用性/n和/cc可伸缩性/l，/w支持/v多/a租户/gi模式/gi、/w容器/gi和/cc对象/gi读写操作/n，/w适合/v解决/v互联网/gi的/ude1应用场景/gi下/f非结构化/gi数据存储/gi问题/gi。/w与/cc通常/d的/ude1分布式文件系统/nz一样/uyy，/w放入/v对象/gi存储/gi集群/gi中的/v文件/gi是/vshi条带/n化/v的/ude1，/w依据/n特定/b的/ude1数据/gi分布式/gi算法/gi放入/v集群/gi节点/gi中/f。/w应用程序/nz可以/v通过/prestful/nz接口/gi与/cc各/rzosd/nz节点/gi其/rz通信/gi，/w将/d对象/gi直接/ad存储/gi在/p集群/gi中/f./nz以/popenstack/nz中的/v对象/gi存储/gi组件/giswift/nz为/p例/n。/w从/pswift/nz的/ude1架构/gi与/cc特性/gi来看/u，/w除了/p极高/d的/ude1数据/gi持久性/gi，/w各个/rz存储/gi的/ude1节点/gi完全/ad对等/vn，/w是/vshi对称/gi的/ude1系统架构/gi；/w扩容/v的/ude1时候/n只需/v简单/a的/ude1增加/v机器/gi，/w扩展性/n很好/ad；/w没有/v主从/gi结构/gi，/w不存在/ns单/b节点/gi故障/gi，/w任意/d一个/mq节点/gi出现/v故障/gi时/qt，/w数据/gi并/cc不会/v丢失/v。/w如/v图/gi6/nz所示/nz分别/d表示/v了/ule上传/v文件/giput/nz和/cc下载/gi文件/giget/gi请求/gi的/ude1数据流/n，/w两/nz个/q请求/gi操作/gi的/ude1是/vshi同一个/b对象/gi。/w上传/v文件/gi时/qt，/wput/nz请求/gi通过/p负载均衡/gi挑选/v一台/nzproxy server/nz，/w将/d请求/gi转发/gi到/v后者/rzv，/w后者/rzv通过/p查询/gi本地/gi的/ude1ring/nz文件/gi，/w选择/gi3/nz个/q不同/azone/nz中的/v后/f端来/nz存储/gi这个/rz文件/gi，/w再/d给/p用户/gi返回/v文件/gi写/v成功/a的/ude1消息/n。/w下载/gi文件/gi时/qt，/wget/gi请求/gi也/d通过/p负载均衡/gi挑选/v一台/nzproxyserver/nz，/w后者/rzv上/f的/ude1ring/nz文件/gi能/v查询/gi到/v这个/rz文件/gi存储/gi在/p哪/ry三个/nz节点/gi中/f，/w然后/c同时/c去向/n后端/f查询/gi，/wproxyserver/nz从/p中/f选择/gi一个/mq节点/gi下载/gi文件/gi。/w图/gi6/nz /x对象/gi存储/giswift/nz的/ude1部署/gi与/cc文件/gi存取/gi3/nz结束语/n企业/gi及/cc互联网/gi数据/gi以/p每年/r50%/nz的/ude1速率/gi在/p增长/gi，/w新增/v数据/gi中/f结构化/n数据/gi总量/n有限/a，/w多数/a为/p非结构化/gi、/w半结构/nz化/v数据/gi，/w数据中心/gi存储/gi架构/gi随着/p业务/gi发展/gi需要/v极强/d的/ude1弹性/n适应能力/nz，/w低成本/nz、/w大容量/n(/nz海量/gi)/nz扩展/gi、/w高并发/gi性能/gi是/vshi面向/v大型/b云数据中心/gi运营/gi存储/gi架构/gi的/ude1基本/a技术/gi属性/gi。/w如何/ryv进行/vn数量/n庞大/a且/c杂乱无章/al的/ude1数据存储/gi与/cc深度/gi应用/gi处理/vn，/w并/cc迅速/ad提取/v有/vyou价/n的/ude1信息/gi，/w形成/v迅速/ad商业/n决策/gi成为/v各/rz类型/gi企业/gi生存/vi基础/gi是/vshi今后/t存储/gi以及/cc围绕/v存储/gi架构/gi不断/d衍生/vn的/ude1业务/gi发展方向/gi。/w因此/c数据/gi存储技术/nz变革/gi方向/gi必然/d是/vshi分布式/gi并行/vn文件系统/gi，/w并行/vn数据库/gi、/w高效/b统一/vn的/ude1数据/gi装载/v及/cc存取/gi，/w多/a接口/gi、/w灵活/a扩展/gi、/w多/a业务/gi承载/v的/ude1解决方案/gi能力/gi是/vshi大容量/n、/w海量/gi存储技术/nz架构/gi的/ude1关键/n。/w