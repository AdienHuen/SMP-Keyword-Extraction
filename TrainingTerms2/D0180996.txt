#比较/gi两/nz大/a虚拟桌面/gi厂商/gi的/ude1系统/gi镜像管理/gi
原文/n地址/gi：/w虚拟桌面/gi的/ude1出现/v，/w极大/a简化/gi了/ule桌面/gi的/ude1管理/gi。/w针对/gi操作系统/gi部分/n，/wvmware/gi和/cccitrix/gi两/nz大/a厂商/gi都/d推出/v了/ule一/nz对/p多/a方式/n的/ude1桌面/gi镜像管理/gi。/wvmware/gi叫/vilink clone/nz技术/gi。/w而/cccitrix/gi有/vyou两/nz种/q，/w一种/nz与/cclink clone/nz技术/gi对应/vi，/w叫做/vmcs/nz；/w另一种/nz是/vshi其/rz独有/v的/ude1，/w叫/vipvs/nz。/w简而言之/vl，/w就是/vit/gi管理员/gi只/d需要/v维护/gi少数/mq操作系统/gi模板/gi，/w虚拟桌面/gi都/d是从/v某/rz一个/mq母版/nz派生/v出来/vf的/ude1。/w只要/c保证/v母版/nz的/ude1系统/gi补丁/gi是/vshi最新/a的/ude1，/w其/rz派生/v出来/vf的/ude1桌面/gi就/d能/v同步/gi到/v最新/a。/w于是/cc打补丁/nz的/ude1工作/gi再也/d不/d需要/v针对/gi数不清/l的/ude1桌面/gi实例/gi来/vf进行/vn了/ule，/w /x管理员/gi得到/v极大/a的/ude1解脱/v。/w但是/c这种/r一对多/nz方式/n的/ude1桌面/gi镜像管理/gi也/d带来/v了/ule一个/mq大/a的/ude1挑战/gi。/w这个/rz挑战/gi不/d解决/v，/w“/w简化/gi桌面/gi管理/gi”/w只能/v是/vshi一个/mq伪命题/nz。/w当/p所有/b虚拟桌面/gi都/d跑/v在/p一个/mq共享/gi存储/gi之上/f时/qt，/w存储/gi最/d可能/v成为/v性能/gi的/ude1瓶颈/gi。/w桌面/gi系统/gi产生/v的/ude1存储/gi访问/gi需求/gi是/vshi随机/b的/ude1，/w不同/a的/ude1用户/gi在/p以/p各种/rz不可/v预测/gi的/ude1方式/n对/p存储/gi产生/v读写访问/n，/w所以/c很难/d做到/v精确/gi计算/gi。/w /x如果/c存储子/nz系统配置/gi过/uguo低/a，/w则/d很容易/nz过载/vn，/w所有/b的/ude1用户/gi都会/n感觉/gi桌面/gi运行/gi很慢/d。/w如果/c配置/gi过/uguo高/a，/w其/rz成本/n又/d会/v爆炸式/n增长/gi，/w彻底/ad淹没/v桌面虚拟化/gi所/usuo带来/v的/ude1好处/gi。/w另外/c桌面上/n的/ude1行为/n往往/d又/d有/vyou一定/b的/ude1趋同性/nz，/w如/v早/a8/nz点/gi同时/c开机/gi，/w /x中午/t空闲/gi时/qt防病毒/gi自动/d扫描/gi，/w同时/c观看/v某个/rz紧急/a培训/gi的/ude1视频/gi片段/n，/w恶意/n病毒/gi繁殖/vn等等/udeng。/w当/p大量/m用户/gi在/p同一时间/nz开始/v并发/gi存储/gi读写/gi任务/gi时/qt，/w /x就/d会/v产生/v /x“/w存储/giio/gi风暴/n”/w，/w最/d糟糕/a的/ude1情况下/nz能/v瘫痪/vi整个/b磁盘柜/nz。/w为了/p解决/v这/rzv一/nz问题/gi，/wvmware/gi和/cccitrix/gi分别/d采取/v了/ule不同/a的/ude1方法/gi来/vf应对/v。/wvmware/gi提出/v分级/gi存储/gi的/ude1概念/gi，/w提倡/v不同/a性质/n的/ude1数据/gi应/v区别对待/v。/w简单理解/gi就是/v花钱/vi来/vf买/v性能/gi。/w /x对于/p系统/gi镜像/gi模板/gi这类/r高频/b访问/gi的/ude1数据/gi，/w他/rr推荐/gi用户/gi放置/gi在/pssd/nz，/w甚至/dflash memory card/nz之上/f。/w由于/p一个/mq20/nzg/nz的/ude1系统/gi模板/gi最大/gm能/v支持/v50/nz~/nz60/nz个/q虚拟桌面/gi开机/gi，/w所以/c当/p虚拟桌面/gi数量/n上/f规模/gi时/qt，/w高速/b存储/gi的/ude1容量/gi也/d要求/n越大/d。/w这类/r商用/b高速/b存储/gi将/d是/vshi一笔不菲/nz的/ude1开销/n，/w要/v知道/v其/rz陡峭/a的/ude1性能/gi增长/gi曲线/gi与/cc成本/n曲线/gi是/vshi成正比/nz的/ude1关系/gi。/w而/cccitrix/gi采用/v了/ule更/d廉价/a更聪明/nz的/ude1做法/n。/w既然/c磁盘操作/n是/vshi计算/gi环节/gi中/f最慢/nz的/ude1部分/n，/w那/rzv我/rr就/d尽量避免/l它/rr。/wcitrix/gi在/p其/rz两/nz种/q镜像管理/gi方法/gi中都/ns使用/gi了/ule镜像/gi缓存/gi技术/gi来/vf分担/gi对/p共享/gi存储/gi的/ude1压力/n。/w例如/vpvs/nz，/w镜像/gi不再/d是从/v共享/gi存储/gi上/f直接/ad访问/gi，/w而是/c由/p“/wprovisioning server/nz”/w来/vf统一/vn分发/v。/w“/wprovisioning server/nz”/w会/v将/d母版/nz镜像缓/nz存在/v内存/gi中/f，/w通过/p网络流/gi送给/v虚拟桌面/gi。/w由于/p整个/b路径/gi上都/ns是/vshi电气/n信号/gi的/ude1转换/gi，/w所以/c性能比/n磁盘/gi的/ude1机械/n操作/gi要/v快得多/d。/w大家/rr可以/v参考/gi以下/f视频/gi，/w更/d直观/a地/ude2了解/vpvs/nz的/ude1开机/gi性能/gi（/wardence/nz是/vshicitrix/gi收购/gi前/f的/ude1名称/n）/wmcsintellicache/nz方法/gi则/d是/vshi将/d集中于/v中央/n共享/gi存储/gi的/ude1压力/n分摊/v到/v每一个/nz虚拟桌面/gi宿主/n服务器/gi上/f。/w一般/ad宿主/n服务器/gi上都/ns配有/v本地/gi硬盘/gi，/w这些/rz硬盘空间/nz不用/d白/a不用/d。/w当/p宿主/n服务器/gi加载/gi第一个/gi虚拟桌面/gi时/qt，/w系统/gi镜像/gi就/d被/pbei缓存/gi在/p本地/gi存储/gi上/f，/w当/p后续/vn虚拟桌面/gi开机/gi时/qt，/w宿主/n服务器/gi如果/c发现/v使用/gi的/ude1是/vshi相同/a模板/gi（/w通常/d就是/v）/w，/w就/d直接/ad从/p本地/gi存储/gi读取/gi，/w不再/d访问共享/gi存储/gi了/ule。/w如果/c桌面/gi是/vshi可回收/nz类型/gi的/ude1，/w那么/c用户/gi在/p桌面上/n的/ude1写/v操作/gi也/d全/a部/q发生/v在/p服务器/gi本地/gi，/w不会/v写到/v共享/gi存储/gi上/f。/w因为/c当/p用户/gi登出/v时/qt，/w虚拟/gi桌面上/n的/ude1临时/gi改变/v都会/n被/pbei丢弃/v。/w无论是/cpvs/nz还是/cmcs/nz都/d是/vshi想方设法/dl将/d共享/gi存储/gi上/f的/ude1iops/nz卸载/gi下来/vf，/w从而/c降低/v虚拟桌面/gi方案/gi对/p高端/nz共享/gi存储/gi的/ude1依赖性/n。/w有/vyou客户/n做/v了/ule一个/mq简单/a的/ude1测试/gi，/w结论/gi是/vshivmware/gi的/ude1link clone/nz技术/gi所需/nz的/ude1iops/nz大致/d是/vshicitrix/gi的/ude11.5/nz倍/q以上/f。/wvmware/gi也/d认识到/v自己/rr方案/gi的/ude1不足/an，/w在/p其/rz后期/f版本/n中/f也/d规划/gi了/ule类/gi于/pcitrix intellicache/nz技术/gi的/ude1缓存/gi方法/gi。/w由于/p该/rz技术/gi尚未/d发布/gi，/w本文/r暂不/d做/v评价/gi。/w后/f记/v：/w这/rzv篇文章/n引起/v了/ule很/d多/a的/ude1争论/vn。/w有/vyou必要/a澄清/vi一下/m。/w使用/gipvs/nz时/qt，/w既/c可以/v创建/gi“/w个人/n专用/gi桌面/gi”/w，/w也/d可以/v创建/gi“/w浮动/vn分配/gi桌面/gi”/w。/w pvs/nz你/rr可以/v把/pba他/rr简单理解/gi成/v一个/mq你/rr“/w自制/v的/ude1ip/gi-/nzsan/gi的/ude1存储”/nz。/w只不过/d这个/rz“/w自制/v存储/gi”/w仅/d用来/v分发/v系统/gi镜像/gi，/w是/vshi只读/v的/ude1。/w而/cc你/rr原有/v的/ude1共享/gi存储/gi主要/b用来/v保存/gi用户数据/gi，/w是/vshi可写/v的/ude1。/w很/d多/a人/n会/v质疑/vnpvs/nz的/ude1性能/gi，/w通过/p网络/gi流送/nzos image/nz，/w会/v在/p网络/gi中/f出现/v瓶颈/gi。/w其实/d拿/vip/gi-/nzsan/gi来/vf做/v参照/v，/w大家/rr都/d要/v对外/vn提供/v基础/gi镜像/gi，/w都/d是/vshi走/v的/ude1ip/gi协议/gi，/wip/gi-/nzsan/gi你/rr就/d不/d担忧/v吗/y？/wpvs/nz直接/ad将/dos image /nz加载/gi到/v内存/gi中/f向/p外/f分发/v，/w它/rr不会/v比/pip/gi-/nzsan/gi从/p磁盘/gi读/v还/d慢/a。/w引入/vpvs/nz方案/gi，/w会/v增加/vserver/gi的/ude1数量/n，/w但/c它/rr的/ude1好处/gi就是/v让/v你/rr有/vyou了/ule突破/gi传统/n存储/gi瓶颈/gi，/w具备/v横向/n扩展/gi的/ude1能力/gi。/w传统/n存储/gi出现/v瓶颈/gi，/w你/rr只能/vscale up/nz，/w大家/rr都/d知道/v动/v存储/gi是/vshi个/q很/d麻烦/an的/ude1事情/n，/w但是/cpvs/nz出现/v瓶颈/gi，/w你/rr可以/v通过/p加/v网卡/gi或者/c增加/vpvs server/nz的/ude1方式/nscale out/nz。/w以上/f比喻/n仅限于/l桌面虚拟化/gi系统/gi基础/gi镜像/gi场景/gi。/w大家/rr不要/d衍生/vn到/v其他/rzv可/v横向/n扩展/gi的/ude1存储技术/nz领域/gi。/w