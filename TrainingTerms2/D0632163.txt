#线程同步/gi(/nz2/nz)/nz―/w―/w悲观锁/gi和/cc乐观锁/gi
  /x上/f一/nz篇/q博客/gi介绍/gi了/ule什么/ry是/vshi线程同步/gi，/w介绍/gi了/ule的/ude1用法/gi，/w这/rzv一/nz篇/q博客/gi总结/gi一/nz下/f悲观锁/gi和/cc乐观锁/gi。/w   /x悲观锁/gi，/w它/rr假设/gi只要/c有/vyou数据/gi访问/gi就/d会/v产生/v冲突/gi，/w当/p一个/mq线程/gi读取数据/n时/qt就/d一定/b要/v上锁/nz，/w其他用户/l无法/v操作/gi，/w直到/v锁/v释放/gi。/w  /x悲观锁/gi是/vshi利用/v数据/gi的/ude1机制/gi实现/gi的/ude1，/w在/p查询/gi时/qt是/vshisql语句/gi中/f加入/v“/wfor update/nz”/w,/nz这样/rzv整个/b事务/gi会/v被/pbei锁住/v，/w只有/c当/p本次/r事务/gi执行/v结束/v后/f才能/n进行/vn下次/t线程/gi操作/gi。/w这/rzv将/d防止/gi其他/rzv进程/gi读取/gi或/c修改/gi表/n中的/v数据/gi   /x乐观锁/gi，/w它/rr假设/gi数据/gi访问/gi时/qt不会/v产生/v冲突/gi，/w只是/d在/p提交/gi事务时/n要/v检查/gi是否/v违反/v了/ule数据完整性/gi，/w更新/gi时/qt检查/gi版本号/gi是否/v一致/a。/w  /x比如/v数据库/gi中/f数据/gi版本/n为/p6/nz，/w更新/gi提交/gi时/qtversion/nz=/nz61/nz,/nz使用/gi该/rzversion/nz(/nz=/nz7/nz)/nz与/cc数据库/giversion/nz1/nz(/nz=/nz7/nz)/nz作/v比较/gi，/w如果/c相等/vi，/w则/d可以/v更新/gi，/w如果/c不等/vi则/d有可能/nz其他/rzv程序/gi已/d更新/gi该/rz记录/gi，/w所以/c返回/v错误/gi。/w乐观/a锁适/nz用于/v对/p数据库/gi读/v的/ude1应用/gi。/w   /x乐观锁/gi更/d适用/vi于/p对于/p表/n的/ude1修改/gi比较/gi少/a的/ude1情况/n，/w而/cc悲观锁/gi更/d实/ad用于/v对于/p数据/gi的/ude1修改/gi比较/gi多/a的/ude1情况/n，/w它/rr能/v保证/v线程同步/gi，/w不/d产生/v脏/a数据/gi。/w