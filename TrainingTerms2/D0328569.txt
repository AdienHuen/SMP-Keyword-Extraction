#【/wJAVA/gi实现/gi】/w朴素贝叶斯/gi分类/gi算法/gi
   /x之前/f博客/gi提到/v的/ude1knn/gi算法/gi以及/cc决策树/gi算法/gi都/d是/vshi要求/n分类器/n给出/v“/w该/rz数据/gi实例/gi属于/v哪/ry一类/b”/w这类/r问题/gi的/ude1明确/a答案/gi，/w正/d因为/c如此/rzv，/w才/d出现/v了/ule使用/gi决策树/gi分类/gi时/qt，/w有时/d无法/v判定/gi某/rz一测试/nz实例/gi属于/v哪/ry一/nz类别/gi。/w使用/gi朴素贝叶斯/gi算法/gi则/d可以/v避免/v这个/rz问题/gi，/w它/rr给出/v了/ule这个/rz实例/gi属于/v某/rz一类/b别的/rzv概率/gi，/w然后/c通过/p比较/gi概率/gi，/w可以/v找到/v该/rz实例/gi最/d有可能/nz属于/v哪/ry一/nz类别/gi。/w   /x该/rz算法/gi可以/v用/p如下/vi形式/gi表示/v：/w   /x直接/ad求解/gi概率/gi很/d困难/an，/w因此/c我们/rr可以/v通过/p下列/b式子/n进行/vn变化/gi。/w   /x因为/c分母/n对于/p所有/b类别/gi都/d是/vshi固定/a，/w所以/c我们/rr只/d要求/n能/v使得/vi分子/gi最大化/v的/ude1类别/gi即可/v。/w又/d因为/c朴素贝叶斯/gi假设/gi各/rz特征/gi属性/gi条件/n独立/a，/w所以/c有/vyou：/w   /x朴素贝叶斯/gi分类器/n通常/d有/vyou两/nz种/q实现/gi方式/n：/w一种/nz基于/p贝努利/nrf模型/gi实现/gi，/w一种/nz基于/p多项式/gi模型/gi实现/gi。/w贝努利实现/nz方式/n也/d称/v“词/nz集模型/nz”/w，/w其/rz不/d考虑词/nz在/p文档/gi中/f出现/v的/ude1次数/gi，/w只/d考虑/v出/vf不/d出现/v，/w因此/c在/p这个/rz意义/n上/f相当于/v假设/gi词/n是/vshi等/udeng权重/nz的/ude1。/w而/cc多项式/gi模型/gi也/d称/v“/w词/n袋/ng模型/gi”/w，/w它/rr考虑词/nz在/p文档/gi中的/v出现/v次数/gi。/w本文/r采用/v的/ude1是/vshi多项式/gi模型/gi。/w   /x这次/r的/ude1案例/gi使用/gi的/ude1是/vshi使用/gi朴素贝叶斯/gi过滤/gi垃圾邮件/nz。/w训练/gi集/q如下/vi所示/nz：/w   /x第一个/gi文件夹/n下放/v的/ude1是/vshi25/nz篇/q正常/a的/ude1纯/a文本/gi邮件/n，/w第二/mq个/q文件/gi夹放/nz的/ude1是/vshi25/nz篇/q纯/a文本/gi垃圾邮件/nz。/w   /x首先/d是/vshi邮件/n内容/gi的/ude1封装/gi。/w   /x第一个/gi字段/gi为/p每封/v邮件/n分好/d词/n的/ude1集合/gi，/w第二个字/nz段/q表示/v这封/nz邮件/n是否是/l垃圾邮件/nz。/w   /x可能/v比较/gi乱/d，/w我/rr把/pba所有/b的/ude1模块/gi写/v在/p了/ule一起/s。/w首先/d是从/v两/nz个/q文件夹/n中/f读取/gi邮件/n，/w建立/gi数据/gi集/q。/w读取/gi同时/c，/w会/v对/p邮件/n的/ude1内容/gi进行/vn分词/gi，/w这里/rzs的/ude1分词/gi规则/gi比较简单/l，/w分隔/vi符/v为/p非/b文本/gi字符/gi，/w可以/v根据/p自己/rr规则/gi定义/gi。/w   /x利用/v贝叶斯/nrf分类器/n对/p文档/gi进行/vn分类/gi时/qt，/w要/v计算/gi多/a个/q概率/gi的/ude1乘积/n以/p获得/v文档/gi属于/v某个/rz类别/gi的/ude1概率/gi，/w如果/c其中/rz一个/mq概率/gi为/p0/nz，/w那么/c最后/f乘积/n也/d为/p0/nz，/w因此/c为/p降低/v这种/r影响/gi，/w可以/v将/d所有/b词/n的/ude1出现/v次数/gi初始/b化为/v1/nz，/w将/d分母/n初始/b化为/v2。/nz另一个/nz问题/gi是/vshi下溢/v，/w这/rzv是/vshi由于/p太多/ad很小/a的/ude1数/n相乘/v造成/v的/ude1，/w导致/gi最后/f四舍五入/nz会/v得到/v0./nz解决办法/n是/vshi对/p乘积/n取/v自然对数/gm。/w   /x最后/f，/w从/p训练样本/n中/f随机/b选取/gi10/nz条/q作为/p测试/gi集/q，/w进行/vn错误/gi率/v计算/gi，/w重复/gi十次/nz，/w取/v平均数/n得到/v最后/f的/ude1错误/gi率/v为/p4%。/nz发现/v结果/n还是/c不错/a的/ude1。/w   /x通过/p特征/gi之间/f的/ude1条件/n独立性/gi假设/gi，/w可以/v降低/v对/p数据量/n的/ude1需求/gi。/w但是/c独立性/gi假设/gi是/vshi指/v一个词/nz的/ude1出现/v概率/gi并不/d依赖于/v文档/gi中的/v其他/rzv词/n，/w可见/c这个/rz假设/gi过于/d简单/a，/w可能会/nz影响/gi最后/f的/ude1准确率/gi。/w   /x如有/c什么/ry问题/gi，/w欢迎/v大家/rr和/cc我/rr一起/s学习/gi探讨/v。/w