#ARP/nz报文格式/n
arp/gi：/w地址解析/gi协议/gi（/waddress resolution protocol/nz,/nz地址解析/gi协议/gi）/w是/vshi将/dip/gi地址解析/gi为/p以太网/gimac/gi地址/gi（/w或/c称/v物理地址/gi）/w的/ude1协议/gi。/w在/p局域网/gi中/f，/w当/p主机/gi或/c其它/rz网络设备/gi有/vyou数据/gi要/v发送给/n另一个/nz主机/gi或/c设备/gi时/qt，/w它/rr必须/d知道/v对方/n的/ude1网络层/gi地址/gi（/w即/vi/nz地址/giip/gi）/w但是/c仅仅/d有/vyouip/gi地址/gi是/vshi不够/a的/ude1，/w因为/cip/gi数据报/gi文/ng必须/d封装/gi成/v帧/q才能/n通过/p物理/n网络/gi发送/gi，/w因此/c发送/gi站/vi还/d必须/d有/vyou接收站/nis的/ude1物理地址/gi，/w所以/c需要/v从/pip/gi地址/gi到/v物理地址/gi，/w所以/c需要/v从/pip/gi地址/gi到/v物理地址/gi的/ude1映射/gi。/warp/gi就是/v实现/gi这个/rz功能/gi的/ude1协议/gi。/warp/gi报文结构/gi前/f8/nz个/q字节/gi是/vshiarp/gi首部/gi，/w后面/f20/nz个/q字节/gi是/vshi源地址/n和/cc目的/gi地址/giarp/gi报文结构/gi硬件/gi类型/gi：/w表示/v硬件地址/nz的/ude1类型/gi，/w为/p1/nz表示/v以太网/gi地址/gi协议/gi类型/gi：/w表明/v上层/f协议/gi的/ude1类型/gi,/nz这里/rzs是/vshi0/nzx/nz0800/nz,/nz表示/v上层/f协议/gi是/vshiip/gi协议/gi硬件地址/nz长度/gi和/cc协议/gi地址/gi长度/gi以/p字节/gi为/p单位/n，/w对于/p以太/nz网上/s的/ude1ip/gi地址/gi的/ude1arp/gi请求/gi或/c应答/gi来说/uls，/w他们/rr的/ude1分别为/v6/nz和/cc4/nz；/w操作/gi类型/gi（/wop/nz）/w:/w1/nz表示/varp/gi请求/gi，/w2/nz表示/varp/gi应答/gi发送/gi端/vmac/gi地址/gi：/w发送/gi方/q设备/gi的/ude1硬件地址/nz；/w发送/gi端/vip/gi地址/gi：/w发送/gi方/q设备/gi的/ude1ip/gi地址/gi；/w目标/gimac/gi地址/gi：/w接收/gi方/q设备/gi的/ude1硬件地址/nz。/w目标/giip/gi地址/gi：/w接收/gi方/q设备/gi的/ude1ip/gi地址/gi。/w完整/a的/ude1以太网帧/gi结构/gi如下/vi：/w前面/f14/nz个/q字节/gi为/p以太网/gi首部/giarp/gi协议/gi和/ccrarp/nz协议/gi前面/f已经/d说/v过/uguo，/warp/gi协议/gi只用/v在/p局域网/gi中/f，/w它/rr用来/v将/dip/gi地址解析/gi为/pmac/gi地址/gi。/w局域网/gi中的/v每个/r主机/gi都/d有/vyou一个/mqarp/gi缓存/gi，/w它/rr保存/gi了/ule最近/t发起/v的/ude1ip/gi地址/gi到/vmac/gi地址/gi的/ude1映射/gi记录/gi，/w当/p该/rz主/ag机要/b向/p局域网/gi中的/v某/rz一/nz主机/gi发送数据/n时/qt，/w它/rr会/v先/d从/p自己/rr的/ude1缓存/gi中/f查找/gi，/w看/v是否/v存在/v目标/giip/gi地址/gi，/w如果/c找到/v，/w就/d通过/p映射/gi找到/v它/rr的/ude1mac/gi地址/gi，/w从而/c发送/gi过去/vf，/w如果/c没有/v找到/v该/rz目的/giip/gi地址/gi，/w它/rr就/d向/p该局/r域网/nz内/f发送/gi一个/mq广播/gi，/w广播/gi中/f包含/v自己/rr的/ude1ip/gi地址/gi、/wmac/gi地址/gi和/cc目的/gi主机/gi的/ude1ip/gi地址/gi，/w局域网/gi内/f的/ude1所有/b主机/gi都会/n收到/v该/rz广播/gi，/w但/c只有/c目的/giip/gi地址/gi的/ude1主/ag机会/gi做出/v回应/vn，/w并/cc把/pba自己/rr的/ude1mac/gi地址/gi发送给/n源/ng主机/gi，/w源/ng主机/gi收到/v后/f，/w在/p自己/rr的/ude1arp/gi缓存/gi中/f增加/v上/f该/rz映射/gi，/w并/cc根据/p发来/v的/ude1mac/gi地址/gi将/d数据/gi发送给/n目的/gi主机/gi。/warp/gi高速缓存/gi中的/v表项/nz一般/ad都/d要/v设置/gi超时/v，/w如果/c一段时间/nz内/f没有/v与/cc某/rz主机/gi通信/gi，/w就/d将/d该/rz主机/gi对应/vi的/ude1ip/gi与/ccmac/gi之间/f的/ude1映射/gi关系/gi去掉/v，/w下次/t在/p需要/v通信/gi时/qt，/w依然/d发送/gi广播/gi。/w如果/carp/gi请求/gi是从/v一个/mq网络/gi的/ude1主机/gi到/v另一个/nz网络/gi的/ude1主机/gi，/w那么/c连接/gi这/rzv两/nz个/q网络/gi的/ude1路由器/gi就/d可以/v回答/v该/rz请求/gi，/w这个/rz过程/gi成为/varp/gi代理/gi。/wrarp/nz协议/gi则/d刚好/d相反/vi，/w它/rr将/dmac/gi地址解析/gi成为/v对应/vi的/ude1ip/gi地址/gi，/w现在/t已/d很少/ad单独/d使用/gi。/w