#网络/gi服务器虚拟化/gi
【/w转/v自/p】/w引子/n接触/v网络虚拟化/gi纯属偶然/nz。/w作为/p研究院/nis微博/n五毛/nz小分队/n的/ude1成员/nnt，/w撰出/nz一条/nz微博/n是/vshi每天/r的/ude1任务/gi。/w那天/r无意中/nz抓取/gi了/ule一条/nz新闻/gi：/wxsigo/nz公司/nis推出/v了/ule业界/n第一个/gi数据中心/gi网络/gi全/a虚拟化/gi解决方案/gi。/w巧/a的/ude1是/vshixsigo/nz公司/nis的/ude1方案/gi是/vshi基于/pinfiniband/nz技术/gi的/ude1，/w而/cc我/rr最近/t的/ude1项目/gi使/v我/rr对/pinfiniband/nz略懂/nz，/w所以/c就/d重点/n关注/v了/ule一下/m。/w这/rzv一/nz关注/v不要紧/vl，/w才/d发现/v里面/f水/n很深/d。/w不管/c是/vshi传统/nit/gi豪强/n还是/c网络/gi巨人/n都/d对/p这/rzv一/nz领域/gi虎视眈眈/vl，/w谋篇/nz定局/n，/w更/d有/vyou无数/m的/ude1创业者/ntc们/k在/p此/rzs展开/v深耕/v。/w /x抱着/v对/p技术/gi要略/n懂/v的/ude1心态/n，/w我/rr入水/v一探/nz究竟/d。/w这/rzv篇/q博文/nz算是/v对/p我/rr这次/r涉水/v的/ude1总结/gi，/w网络虚拟化/gi发展/gi到/v现在/t牵涉/v的/ude1技术/gi非常/d多/a，/w每种/r技术/gi都/d可以/v单独/d写/v一篇/nz文章/gi来/vf介绍/gi，/w限于/v我/rr的/ude1精力/n和/cc知识/gi水平/n只能/v给/p大家/rr做/v个/q整体/n的/ude1简单/a介绍/gi，/w不足之处/i还/d请/v各位/rr批评指正/nz。/w如果/c读者/n对/p某种/rz技术/gi感兴趣/a可以/v搜索/gi相关/vn资料/gi做/v更/d详细/gi的/ude1了解/v。/w什么/ry是/vshi网络虚拟化/gi首先/d我们/rr需要/v明确/a一个/mq问题/gi，/w什么/ry是/vshi网络虚拟化/gi，/w网络虚拟化/gi简单/a来讲/uls是/vshi指/v把/pba逻辑/n网络/gi从/p底层/n的/ude1物理/n网络/gi分离/vi开来/v。/w这个/rz概念/gi产生/v的/ude1比较/gi久/a了/ule，/wvlan/nz，/wvpn/gi，/w vpls/nz等/udeng都/d可以/v归/v为/p网络虚拟化/gi的/ude1技术/gi。/w近年来/dl，/w云计算/gi的/ude1浪潮/gi席卷/vit/gi界/n。/w几乎/d所有/b的/ude1it/gi基础/gi构架/n都/d在/p朝着/p云/gi的/ude1方向/gi发展/gi。/w在/p云计算/gi的/ude1发展/gi中/f，/w虚拟化技术/gi一直/d是/vshi重要/a的/ude1推动/v因素/gi。/w作为/p基础/gi构架/n，/w服务器/gi和/cc存储/gi的/ude1虚拟化/gi已经/d发展/gi的/ude1有声有色/al，/w而/cc同/p作为/p基础/gi构架/n的/ude1网络/gi却/d还是/c一直/d沿用/v老/a的/ude1套路/n。/w在/p这种/r环境/n下/f，/w网络/gi确实/ad期待/v一次/nz变革/gi，/w使/v之/uzhi更加/d符合/v云计算/gi和/cc互联网/gi发展/gi的/ude1需求/gi。/w云计算/gi的/ude1大环境/n下/f，/w网络虚拟化/gi的/ude1定义/gi没有/v变/v，/w但是/c其/rz包含/v的/ude1内容/gi却/d大大/d增加/v了/ule。/w云计算/gi环境/n下/f的/ude1网络虚拟化/gi需要/v解决/v端/v到/v端的/z问题/gi，/w笔者/n将/d其/rz归纳/v为/p三个/nz部分/n：/w（/w一/nz）/w第一/mq部分/n是/vshi服务器/gi内部/f。/w随着/p越来越/d多/a的/ude1服务器/gi被/pbei虚拟化/gi，/w网络/gi已经/d延伸/v到/vhypervisor/gi内部/f，/w网络通信/gi的/ude1端/v已经/d从/p以前/f的/ude1服务器/gi变成/v了/ule运行/gi在/p服务器/gi中的/v虚拟机/gi，/w数据包/gi从/p虚拟机/gi的/ude1虚拟/gi网卡/gi流出/v，/w通过/phypervisor/gi内部/f的/ude1虚拟/gi交换机/gi，/w在/p经过/p服务器/gi的/ude1物理/n网卡/gi流出/v到/v上联/n交换机/gi。/w在/p整个/b过程/gi中/f，/w虚拟/gi交换机/gi，/w网卡/gi的/ude1i/nz//nzo/nz问题/gi以及/cc虚拟机/gi的/ude1网络/gi接入/vn都/d是/vshi研究/gi的/ude1重点/n。/w（/w二/nz）/w第二部分/nz是/vshi服务器/gi到/v网络/gi的/ude1连接/gi。/w10/nzgb/nz以太网/gi /x和/ccinfiniband/nz等/udeng技术/gi的/ude1发展/gi使/v一根/nz连接线/n上/f承载/v的/ude1带宽/n越来越/d高/a。/w为了/p简化/gi，/w通过/p一种/nz连接/gi技术/gi聚合/gi互联网络/n和/cc存储/gi网络/gi成为/v了/ule一个/mq趋势/gi。/w（/w三/nz）/w第三部分/nz是/vshi网络/gi交换/gi，/w需要/v将/d物理/n网络/gi和/cc逻辑/n网络/gi有效/gi的/ude1分离/vi，/w满足/v云计算/gi多/a租户/gi，/w按/p需/v服务/gi的/ude1特性/gi，/w同时/c具有/v高度/d的/ude1扩展性/n。/w下面/f我/rr就/d围绕/v这/rzv三个/nz方面/n来/vf讲述/v网络虚拟化/gi中的/v一些/m主要/b技术/gi和/cc标准/gi。/w服务器/gi内部/fi/nz//nzo/nz虚拟化/gi多/a个/q虚拟机/gi共享/gi服务器/gi中的/v物理/n网卡/gi，/w需要/v一种/nz机制/gi既能/b保证/vi/nz//nzo/nz的/ude1效率/gi，/w又/d要/v保证/v多/a个/q虚拟机/gi对/p用/p物理/n网卡/gi共享/gi使用/gi。/wi/nz//nzo/nz虚拟化/gi的/ude1出现/v就是/v为了/p解决/v这类/r问题/gi。/wi/nz//nzo/nz虚拟化/gi包括/v了/ule从/pcpu/gi到/v设备/gi的/ude1一揽子/n解决方案/gi。/w从/pcpu/gi的/ude1角度看/v，/w要/v解决/v虚拟机/gi访问/gi物理/n网卡/gi等/udengi/nz//nzo/nz设备/gi的/ude1性能/gi问题/gi，/w能/v做/v的/ude1就是/v直接/ad支持/v虚拟机/gi内存/gi到/v物理/n网卡/gi的/ude1dma/nz操作/gi。/wintel/gi的/ude1 vt/nz-/nzd/nz技术/gi及/cc amd /nz的/ude1iommu/nz技术/gi通过/pdmaremapping /nz机制/gi来/vf解决/v这个/rz问题/gi。/wdmaremapping/nz机制/gi主要/b解决/v了/ule两/nz个/q问题/gi，/w一方面/c为/p每个/rvm/nz创建/gi了/ule一个/mqdma/nz保护/gi域/ng并/cc实现/gi了/ule安全/gi的/ude1隔离/vn，/w另一方面/c提供/v一种/nz机制/gi是/vshi将/d虚拟机/gi的/ude1guestphysical address/nz翻译/gi为/p物理机/nz的/ude1hostphysical address/nz。/w从/p虚拟机/gi对/p网卡/gi等/udeng设备/gi访问/gi角度看/v，/w传统/n虚拟化/gi的/ude1方案/gi是/vshi虚拟机/gi通过/phypervisor/gi来/vf共享/gi的/ude1访问/gi一个/mq物理/n网卡/gi，/whypervisor/gi需要/v处理/vn多/a虚拟机/gi对/p设备/gi的/ude1并发访问/gi和/cc隔离/vn等/udeng。/w这样/rzvhypervisor/gi容易/ad行成一个/nz性能/gi瓶颈/gi。/w为了/p提高/v性能/gi，/w一种/nz /x做法/n是/vshi虚拟机/gi绕过/vhypervisor/gi直接/ad操作/gi物理/n网卡/gi，/w这种/r做法/n通常/d称作/vpcipass through/nz，/wvmware/gi，/wxen/nz和/cckvm/nz都/d支持/v这种/r技术/gi。/w但/c这种/r做法/n的/ude1问题/gi是/vshi虚拟机/gi通常/d需要/v独占一个/nzpci/nz插槽/gi，/w不是/c一个/mq完整/a的/ude1解决方案/gi，/w成本/n较高/ad且/c扩展性/n不足/an。/w /x另一种/nz做法/n是/vshi设备/gi如/v网卡/gi直接/ad对/p上层/f操作系统/gi或/chypervisor/gi提供/v虚拟化/gi的/ude1功能/gi，/w一个/mq以太网卡/nz可以/v对/p上层/f软件/gi提供/v多/a个/q独立/a的/ude1虚拟/gi的/ude1pcie/gi设备/gi并/cc提供/v虚拟/gi通道/n来/vf实现/gi并发/gi的/ude1访问/gi。/w这种/r方法/gi也/d是/vshi业界/n主流/gi的/ude1做法/n和/cc发展方向/gi，/w目前/t已经/d形成/v了/ule标准/gi，/w主要/b包括/vsr/nz-/nziov/nz(/nzsingleroot io virtualization/nz)/nz和/ccmr/nz-/nziov/nz(/nzmulti/nz-/nzrootio virtualization/nz)/nz。/w这/rzv方面/n的/ude1技术/gi在/p网上/s已有/v很好/ad的/ude1文章/gi来/vf做/v介绍/gi，/w推荐/gi想/v进一步/d了解/v的/ude1同学/n读一读/v：/w虚拟/gi接入/vn在/p传统/n的/ude1服务器虚拟化/gi方案/gi中/f，/w从/p虚拟机/gi的/ude1虚拟/gi网卡/gi发出/v的/ude1数据包/gi在/p经过/p服务器/gi的/ude1物理/n网卡/gi传送/v到/v外部/f网络/gi的/ude1上联/n交换机/gi后/f，/w虚拟机/gi的/ude1标识/n信息/gi被/pbei屏蔽掉/i了/ule，/w上/f联/vg交换机/gi只能/v感知/gi从/p某个/rz服务器/gi的/ude1物理/n网卡/gi流出/v的/ude1所有/b流量/gi而/cc无法/v感知/gi服务器/gi内/f某个/rz虚拟机/gi的/ude1流量/gi，/w这样/rzv就/d不能/v从/p传统/n网络设备/gi层面/n来/vf保证/vqos/nz和/cc安全/gi隔离/vn。/w虚拟/gi接入/vn要/v解决/v的/ude1问题/gi是/vshi要/v把/pba虚拟机/gi的/ude1网络流量/nz纳入/v传统/n网络/gi交换/gi设备/gi的/ude1管理/gi之中/f，/w需要/v对/p虚拟机/gi的/ude1流量/gi做/v标识/n。/w在/p解决/v虚拟/gi接入/vn的/ude1问题/gi时/qt，/w思科/ntc和/cc惠普/ntc分别/d提出/v了/ule自己/rr的/ude1解决方案/gi。/w思科/ntc的/ude1是/vshivn/nz-/nztag/nz,/nz /x惠普/ntc的/ude1方案/gi是/vshivepa/nz(/nzvirtualethernet port aggregator/nz)/nz。/w为了/p制定/gi下一代/n网络/gi接入/vn的/ude1话语权/nz，/w思科/ntc和/cc惠普/ntc这/rzv两/nz个/q巨头/n在/p各自/rr的/ude1方案/gi上都/ns毫不/d让步/vn，/w纷纷/d将/d自己/rr的/ude1方案/gi提交/gi为/p标准/gi，/w分别为/v802.1/nzqbh/nz和/cc802.1/nzqbg/nz。/w关于/p虚拟/gi接入/vn也/d有/vyou一篇/nz很好/ad的/ude1文章/gi来/vf介绍/gi，/w想/v深入/ad了解/v的/ude1可以/v看看/v：/w网络连接/nz网络连接/nz技术/gi一直/d都/d在/p追求/v更高/d的/ude1带宽/n中/f发展/gi。/w比如/vinfiniband/nz和/cc10/nzgb/nz以太网/gi。/w在/p传统/n的/ude1企业级/nz数据中心/giit/gi构架/n中/f，/w服务器/gi到/v存储/gi网络/gi和/cc互联网络/n的/ude1连接/gi是/vshi异构/gi和/cc分开/vi的/ude1。/w存储/gi网络/gi用/p光纤/n，/w互联网/gi用以/d太/d网线/n（/wiscsi/nz虽然/c能够/v在/pip/gi层/gi上/f跑/vscsi/nz，/w但是/c性能/gi与/cc光纤/n比/p还是/c差/a的/ude1很远/d）/w。/w数据中心/gi连接/gi技术/gi的/ude1发展趋势/l是/vshi用/p一种/nz连接线/n将/d数据中心/gi存储/gi网络/gi和/cc互联网络/n聚合起来/l，/w使/v服务器/gi可以/v灵活/a的/ude1配置/gi网络/gi端口/gi，/w简化/giit/gi部署/gi。/w以太/nz网上/s的/ude1fcoe/nz技术/gi和/ccinfiniband/nz技术/gi本身/rz都/d使/v这种/r趋势/gi成为/v可能/v。/winfinibandinfiniband /nz技术/gi产生/v于/p上个/b世纪末/t，/w是/vshi由/pcompaq/nz、/w、/w、/w、/w、/w和/cc七家/nz公司/nis共同/d研究/gi发展/gi的/ude1高速/b先进/a的/ude1i/nz//nzo/nz标准/gi。/w最初/d的/ude1命名/v为/psystemi/nz//nzo/nz，/w1999/nz年/qt10/nz月/n，/w正式/ad改名/vi为/pinfiniband/nz。/winfiniband/nz是/vshi一/nz种/q长/a缆线/nz的/ude1连接/gi方式/n，/w具有/v高速/b、/w低/a延迟/v的/ude1传输/gi特性/gi。/w基于/pinfiniband/nz技术/gi的/ude1网卡/gi的/ude1单端/nz口带宽/nz可达/nz20/nzgbps/nz,/nz最初/d主要/b用/p在/p高性能计算/gi系统/gi中/f，/w近年来/dl随着/p设备/gi成本/n的/ude1下降/vi，/winfiniband/nz也/d逐渐/d被/pbei用/p到/v企业/gi数据中心/gi。/w为了/p发挥/vinfiniband/nz设备/gi的/ude1性能/gi，/w需要/v一/nz整套/b的/ude1软件/gi栈来/nz驱动/gi和/cc使用/gi，/w这/rzv其中/rz最/d著名/a的/ude1就是/vofed/nz(/nzopenfabrics enterprise distribution/nz)/nz /x,/nz它/rr基于/pinfiniband/nz设备/gi实现/gi了/ulerdma/nz(/nzremote direct memoryaccess/nz)/nz./nzrdma/nz的/ude1最主要/nz的/ude1特点/n就是/v零拷贝/gi和/cc旁路/ns操作系统/gi，/w数据/gi直接/ad在/p设备/gi和/cc应用程序/nz内存/gi之间/f传递/v，/w这种/r传递/v不/d需要/vcpu/gi的/ude1干预/vn和/cc上下文/gi切换/vn。/wofed/nz还/d实现/gi了/ule一系列/b的/ude1其它/rz软件栈/nz：/wipoib/nz(/nzip over infiniband/nz)/nz,/nz srp/nz(/nzscsi rdma protocol/nz)/nz等/udeng，/w这/rzv就/d为/pinfiniband/nz聚合/gi存储/gi网络/gi和/cc互联网络/n提供/v了/ule基础/gi。/wofed/nz由/popenfabrics/nz联盟/gi负责/v开发/gi。/wopenfabrics/nz最初/d叫做/vopenib/nz,/nz从/p2006/nz年/qt开始/vopenib/nz在/pinfiniband/nz之外/f也/d开始/v支持/v以太网/gi，/w业务/gi做/v的/ude1大/a了/ule名字/n也/d从/popenib/nz改为/vopenfabrics/nz。/wofed/nz现/tg已经/d被/pbei主流/gi的/ude1linux/gi发行/v版本/n支持/v，/w并/cc被/pbei整合/gi到/v微软/ntc的/ude1windowsserver/nz中/f。/w图/gi1/nzofed /nz软件/gi栈/gifcoe/nz就/d在/p大家/rr认为/vinfiniband/nz就是/v数据中心/gi连接/gi技术/gi的/ude1未来时/nz，/w10/nzgb/nz以太网/gi的/ude1出现/v让/v人/n看到/v了/ule其它/rz选择/gi，/w以太网/gi的/ude1发展/gi好像/v从来未有/i上限/n，/w目前/t它/rr的/ude1性能/gi已经/d接近/vinfiniband/nz（/w详见/nz）/w,/nz而/cc从/p现有/v网络/gi逐渐/d升级/vi到/v10/nzgb/nz以太网/gi也/d更易/d为/p用户/gi所/usuo接受/gi。/wfcoe/nz的/ude1出现/v则/d为/p数据中心/gi互联网络/n和/cc存储/gi网络/gi的/ude1聚合/gi提供/v了/ule另一种/nz可能/v。/wfcoe/nz是/vshi将/d光纤/n信道/n直接映射/gi到/v以太/nz网线/n上/f，/w这样/rzv光纤/n信道/n就/d成/v了/ule以太/nz网线/n上/f除了/p互联网/gi网络协议/nz之外/f的/ude1另一种/nz网络协议/nz。/wfcoe/nz能够/v很容易/nz的/ude1和/cc传统/n光纤网络/nz上/f运行/gi的/ude1软件/gi和/cc管理工具/nz相/d整合/gi，/w因而/c能够/v代替/v光纤/n连接/gi存储/gi网络/gi。/w虽然/c出现/v的/ude1晚/tg，/w但/cfcoe/nz发展/gi极其/d迅猛/a。/w与/ccinfiniband/nz技术/gi需要/v采用/v全新/b的/ude1链路/gi相比/vi,/nz企业/giit/gi们/k更/d愿意/v升级/vi已有/v的/ude1以太网/gi。/w在/p两者/rzv性能/gi接近/v的/ude1情况下/nz，/w采用/vfcoe/nz方案/gi乎/y性价比/nz更高/d。/w网络/gi交换/gi在/p这/rzv一/nz层面/n上/f要/v解决/v的/ude1问题/gi则/d是/vshi要/v对/p现有/v的/ude1互联网络/n进行/vn升级/vi，/w使/v之/uzhi满足/v新/a业务/gi的/ude1需求/gi，/w网络虚拟化/gi则/d是/vshi这/rzv一/nz变革/gi的/ude1重要/a方向/gi。/w在/p这/rzv一方向/nz上/f目前/t有/vyou两/nz种/q做法/n，/w一种/nz是/vshi在/p原有/v的/ude1基础设施/gi上/f添加/gi新的/a协议/gi来/vf解决/v新的/a问题/gi；/w另一种/nz则/d完全/ad推倒重来/nz，/w希望/v设计/gi出/vf一/nz种/q新的/a网络/gi交换/gi模型/gi。/w当/p虚拟/gi数据中心/gi开始/v普及/v后/f，/w虚拟/gi数据中心/gi本身/rz的/ude1一些/m特性/gi带来/v对/p网络/gi新的/a需求/gi。/w物理机/nz的/ude1位置/gi一般/ad是/vshi相对/d固定/a的/ude1，/w虚拟化/gi方案/gi的/ude1一个/mq很大/d的/ude1特性/gi在于/v虚拟机/gi可以/v迁移/gi。/w当/p虚拟机/gi的/ude1迁移/gi发生/v在/p不同/a网络/gi，/w不同/a数据中心/gi之间/f时/qt，/w对/p网络/gi产生/v了/ule新的/a要求/n，/w比如/v需要/v保证/v虚拟机/gi的/ude1ip/gi在/p迁移/gi前后/f不/d发生/v改变/v，/w需要/v保证/v虚拟机/gi内/f运行/gi在/p第二层/nz（/w链路层/nz）/w的/ude1应用程序/nz也/d在/p迁移/gi后/f仍/d可以/v跨越/v网络/gi和/cc数据中心/gi进行/vn通信/gi等等/udeng。/w在/p这/rzv方面/n，/wcisco/gi连续/gi推出/v了/uleotv/nz，/wlisp/nz和/ccvxlan/gi等/udeng一系列/b解决方案/gi。/wotvotv/nz的/ude1全称/n叫做/voverlaytransport virtualization/nz。/w通过/p扩展链/nz路层/nz网络/gi，/w它/rr可以/v使/v局域网/gi跨越/v数据中心/gi。/w很/d多/a应用/gi需要/v使用/gi广播/gi和/cc本地/gi链路/gi多播/gi。/w通过/p扩展链/nz路层/nz网络/gi，/wotv/nz技术/gi能够/v跨/v地域/n的/ude1处理/vn广播/gi流/gi和/cc多播/gi，/w这/rzv使得/vi这些/rz应用/gi所在/n的/ude1虚拟机/gi在/p数据中心/gi之间/f迁移/gi后/f仍然/d能够/v正常/a工作/gi。/wotv/nz扩展/gi了/ule链路层/nz网络/gi实际上/d也/d扩展/gi了/ule其/rz相关/vn的/ude1ip/gi子网/gm，/w需要/vip/gi路由/gi同样/d的/ude1做/v改变/v，/w这/rzv就/d引出/v了/ule新的/a问题/gi，/w这个/rz问题/gi就/d由/plisp/nz来/vf解决/v了/ule。/wlisplisp/nz的/ude1全称/n是/vshilocator/nz//nzid separation protocol/nz。/w传统/n的/ude1网络地址/giip/gi蕴含/v了/ule两/nz个/q含义/n，/w一个/mq是/vshi你/rr是/vshi谁/ry（/wid/nz）/w，/w另一个/nz是/vshi你/rr在/p哪里/rys（/wlocator/nz）/w。/w这样/rzv带来/v的/ude1一个/mq问题/gi就是/v如果/c你/rr的/ude1位置/gi变/v了/ule（/wlocator/nz变/v了/ule）/w，/wip/gi必须/d跟着/v变化/gi。/wlisp/nz的/ude1目标/gi是/vshi将/did/nz和/cclocator/nz分开/vi，/w再/d通过/p维护/gi一个/mq映射/gi系统/gi将/d两者/rzv关联/vn。/w这样/rzv虚拟机/gi和/cc服务器/gi在/p网络/gi不同/a位置/gi进行/vn迁移/gi时/qt可以/v保持/v相同/a的/ude1ip/gi地址/gi。/w图/gi2/nzotv/nz和/cclisp/nz的/ude1应用/givxlanvxlan/nz的/ude1目的/gi是/vshi在/p云计算/gi环境/n中/f创建/gi更多/ad的/ude1逻辑/n网络/gi。/w在/p云计算/gi的/ude1多/a租户/gi环境/n中/f，/w租户/gi都/d需要/v一个/mq逻辑/n网络/gi，/w并且/c与/cc其它/rz逻辑/n网络/gi能够/v进行/vn很好/ad的/ude1隔离/vn。/w在/p传统/n网络/gi中/f，/w逻辑/n网络/gi的/ude1隔离/vn是/vshi通过/pvlan/nz技术/gi来/vf解决/v的/ude1。/w不幸/a的/ude1是/vshi在/pieee/nz802.1/nzq/nz标准/gi中/f，/wvlan/nz的/ude1标识号/n只有/c12/nz位/q，/w这/rzv就/d限制/vn了/ule在/p一定/b范围内/nz虚拟/gi网络/gi最多/ad只能/v扩展到/v4/nzk/nz个/qvlans/nz。/w为了/p解决/v这个/rz问题/gi，/w思科/ntc联合/givmware/gi在/p今年/t推出/v了/ulevxlan/gi技术/gi，/w通过/pmacin user datagram protocol/nz(/nzmac/gi-/nzin/nz-/nzudp/gi)/nz封装/gi技术/gi，/w加入/v了/ule一个/mq24/nz位/q的/ude1段/q标识符/n。/w用/pudp/gi的/ude1多播/gi代替/v广播/gi，/w将/d数据包/gi限定/v在/p目标/gi网段/gi内/f。/wvxlan/gi技术/gi极大/a的/ude1扩充/v了/ule云计算/gi环境/n中所/j能/v支持/v的/ude1逻辑/n网络/gi的/ude1数量/n，/w同时/c通过/p逻辑/n段/q可以/v将/d逻辑/n网络/gi扩展到/v不同/a的/ude1子网/gm内/f，/w使/v虚拟机/gi能够/v在/p不同/a的/ude1子网/gm间/f做/v迁移/gi。/w图/gi3/nzvxlan /nz帧/q式/k图/gi4/nz /x通过/pvxlan/gi来/vf扩展/gi网络/ginvgre/nz对于/p云计算/gi环境/n中的/v下一代/n网络/gi，/w各/rz大/ait/gi厂商/gi们/k都/d不想/v随便/ad就/d丢掉/v话语权/nz，/w就/d在/pcisco/gi推出/vvxlan/gi不久/d，/wmicrosoft/nz就/d联合/giintel/gi,/nz hp dell /nz提出/v了/ule标准/gi。/wnvgre/nz的/ude1全称/n是/vshinetworkvirtualization using generic routing encapsulation/nz。/w它/rr和/ccvxlan/gi解决/v相同/a的/ude1问题/gi，/w只是/d用/p了/ule稍微/d不同/a的/ude1方式/n，/w使用/gigre /nz(/nzgeneric routing encapsulation/nz)/nz key/nz的/ude1低/a24/nz位/q作为/p网络/gi租户/gi的/ude1标识符/n。/w前面/f我们/rr讲/v的/ude1都/d是/vshi在/p原有/v的/ude1基础设施/gi上/f添加/gi新的/a协议/gi来/vf解决/v新/a出现/v的/ude1问题/gi,/nz而/cc近年来/dlsoftwaredefined networking /nz(/nzsdn/gi)/nz /x的/ude1兴起/v则/d期待/v从根本上/nz改变/v目前/t的/ude1网络/gi交换/gi模式/gi。/wsdn/gi中/f最/d著名/a的/ude1就是/vopenflow/gi。/wopenflow/gi0/nzpenflow/nz论坛/gi起源于/v的/ude1“/wclean slate/nz”/w计划/gi，/w开始/v主要/b是/vshi为了/p设计/gi一种/nz新的/a互联网/gi实验/gi环境/n。/w在/p目前/t的/ude1实验/gi网上/s没有/v实际/n足够/v多/a的/ude1用户/gi或者/c足够/v大/a的/ude1网络拓扑/gi来/vf测试/gi新/a协议/gi的/ude1性能/gi和/cc功能/gi，/w最好/d的/ude1方法/gi是/vshi将/d运行/gi新/a协议/gi的/ude1实验/gi网络/gi嵌入/v实际/n运营/gi的/ude1网络/gi，/w利用/v实际/n的/ude1网络/gi环境/n来/vf检验/gi新/a协议/gi的/ude1可行性/gi和/cc存在的问题/gi。/wopenflow/gi的/ude1切入点/n是/vshi目前/t已有/v的/ude1互联网/gi上/f的/ude1交换/gi设备/gi。/w无论是/c交换机/gi还是/c路由器/gi，/w最/d核心/n的/ude1信息/gi都保/nz存在/vflowtable/nz里面/f，/w这些/rzflowtable/nz用来/v实现/gi诸如/v转发/gi、/w统计/gi、/w过滤/gi等/udeng各种/rz功能/gi。/w虽然/c不同/a生产厂家/n有/vyou不同/a式/k的/ude1flowtable/nz，/w但/c可以/v抽取/v出/vf绝大/nz多数/aswitch/nz和/ccrouter/nz都/d有的/rz一些/m通用/gi的/ude1功能/gi。/wopenflow/gi试图/v提出/v一种/nz通用/gi的/ude1flowtable/nz设计/gi，/w能/v被/pbei所有/b厂家/n的/ude1设备/gi所/usuo支持/v。/w通过/p控制/vnflowtable/nz能够/v实现/gi网络流量/nz的/ude1分区/gi，/w将/d网络流量/nz划分/v为/p不同/a的/ude1数据流/n，/w这些/rz数据/gi流能/nz被/pbei归于/v不同/a的/ude1组/n且/c相互/d隔离/vn，/w能够/v按照/p需要/v来/vf处理/vn和/cc控制/vn。/w更/d重要/a的/ude1是/vshiflowtable/nz支持/v远程/gi的/ude1访问/gi和/cc控制/vn。/wopenflow/gi的/ude1flowtable/nz中/f每一个/nzentry/nz支持/v3/nz个/q部分/n：/w规则/gi，/w操作/gi与/cc状态/gi。/w规则/gi是/vshi用来/v定义/giflow/nz；/w操作/gi就是/v转发/gi、/w丢弃/v等/udeng行为/n；/w状态/gi部分/n则/d是/vshi主要/b用来/v做/v流量/gi的/ude1统计/gi。/w有/vyou了/uleopenflow/gi,/nz我们/rr可以/v在/p正常/a运行/gi的/ude1网络/gi中/f自己/rr定义/gi一/nz些/q特殊/a的/ude1规则/gi，/w通过/p定义/gi不同/a的/ude1flowentry/nz让/v符合/v规则/gi的/ude1流量/gi按照/p我们/rr的/ude1需求/gi走/v任意/d的/ude1路径/gi，/w可以/v达到/v把/pba物理/n网络/gi切成/v若/c干/v不同/a的/ude1虚拟/gi逻辑/n网络/gi目的/gi。/w所以/c，/wopenflow/gi将/d传统/n的/ude1互联网/gi改造/vn成为/v了/ule动态/gi可变/vn的/ude1软件/gi定义/gi互联网/gi（/wsoftwaredefined networking /nz）/w。/wopenflow/gi的/ude1发展/gi异常/gi迅猛/a，/w就/d连/uliancisco/gi如今/t也/d开始/v拥抱/vopenflow/gi。/w总结/gi网络虚拟化/gi当前/tit/gi发展/gi最/d热门/a的/ude1方向/gi之一/rz，/w是/vshi云计算/gi基础架构/n的/ude1核心技术/nz。/w网络虚拟化/gi涉及/v的/ude1面/nf非常/d的/ude1广/a，/w本文/r也/d只/d根据/p笔者/n的/ude1认识/v做/v了/ule粗浅/a的/ude1介绍/gi。/w备注/n在/p网络虚拟化/gi方面/n不仅/c很/d多/a大/a公司/nis在/p抢占/gi话语权/nz，/w很/d多/a初创/vi公司/nis也/d在/p努力/gi开拓/v机会/gi，/w这里/rzs把/pba我/rr所/usuo知道/v的/ude1中/f小/a公司/nis稍微/d做/v下/f总结/gi，/w供/vi大家/rr参考/gi：/wnicira/nz：/w专注/vi于/popenflow/gi的/ude1神秘/a公司/nis。/w：/w提供/v基于/popenflow/gi的/ude1网络虚拟化/gi解决方案/gijuniper networks/nz：/w支持/vopenflowopen vswitch/nz:/w /x一个/mq开源/gi的/ude1虚拟/giswitch/nz，/w它/rr是/vshi一个/mq软件/giswitch/nz能/v运行/gi在/phypervisor/gi里/f,/nz /x目前/t已是/d的/ude1缺省/nzswitch/nz。/wcontextream/nz：/w借鉴/gigrid/nz的/ude1思想/gi，/w通过/pdht/nz（/wdistributed hash table/nz）/w在/p传统/n的/ude1网络/gi之上/f建立/gi一个/mq虚拟/gi的/ude1抽象/gi的/ude1网络/gi，/w解决/v云主机/gi服务提供商/nz们/k在/p网络/gi灵活性/gi，/w多/a租户/gi和/cc扩展性/n方面/n的/ude1挑战/gi。/wembrane/nz：/w /x提供/v一种/nzon/nz-/nzdemand/nz的/ude1虚拟化/gi网络服务/nz，/w比如/v服务/gi的/ude1负载均衡/gi，/w防火墙/gi，/wvpn/gi。/wxsigo/nz:/w提供/v基于/pinfiniband/nz技术/gi的/ude1数据中心/gi全/a虚拟化/gi方案/gi。/wnextio/nz：/w提供/v基于/ppcie/gi技术/gi /x的/ude1i/nz//nzo/nz虚拟化/gi产品/gi。/w